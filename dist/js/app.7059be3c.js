(function(e){function t(t){for(var a,o,r=t[0],c=t[1],l=t[2],p=0,d=[];p<r.length;p++)o=r[p],Object.prototype.hasOwnProperty.call(s,o)&&s[o]&&d.push(s[o][0]),s[o]=0;for(a in c)Object.prototype.hasOwnProperty.call(c,a)&&(e[a]=c[a]);u&&u(t);while(d.length)d.shift()();return n.push.apply(n,l||[]),i()}function i(){for(var e,t=0;t<n.length;t++){for(var i=n[t],a=!0,r=1;r<i.length;r++){var c=i[r];0!==s[c]&&(a=!1)}a&&(n.splice(t--,1),e=o(o.s=i[0]))}return e}var a={},s={app:0},n=[];function o(t){if(a[t])return a[t].exports;var i=a[t]={i:t,l:!1,exports:{}};return e[t].call(i.exports,i,i.exports,o),i.l=!0,i.exports}o.m=e,o.c=a,o.d=function(e,t,i){o.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},o.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(e,t){if(1&t&&(e=o(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(o.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)o.d(i,a,function(t){return e[t]}.bind(null,a));return i},o.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="";var r=window["webpackJsonp"]=window["webpackJsonp"]||[],c=r.push.bind(r);r.push=t,r=r.slice();for(var l=0;l<r.length;l++)t(r[l]);var u=c;n.push([0,"chunk-vendors"]),i()})({0:function(e,t,i){e.exports=i("56d7")},"0714":function(e,t,i){},"0c52":function(e,t,i){},"0eb2":function(e,t,i){"use strict";var a=i("4a9f"),s=i.n(a);s.a},"102e":function(e,t,i){(function(e){i("c975"),i("ace4"),i("d3b7"),i("ac1f"),i("5319"),i("5cc6"),i("9a8c"),i("a975"),i("735e"),i("c1ac"),i("d139"),i("3a7b"),i("d5d6"),i("82f8"),i("e91f"),i("60bd"),i("5f96"),i("3280"),i("3fcc"),i("ca91"),i("25a1"),i("cd26"),i("3c5d"),i("2954"),i("649e"),i("219c"),i("170b"),i("b39a"),i("72f7"),window.LZString={_keyStr:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",_f:String.fromCharCode,compressToBase64:function(e){if(null==e)return"";var t,i,a,s,n,o,r,c="",l=0;e=LZString.compress(e);while(l<2*e.length)l%2==0?(t=e.charCodeAt(l/2)>>8,i=255&e.charCodeAt(l/2),a=l/2+1<e.length?e.charCodeAt(l/2+1)>>8:NaN):(t=255&e.charCodeAt((l-1)/2),(l+1)/2<e.length?(i=e.charCodeAt((l+1)/2)>>8,a=255&e.charCodeAt((l+1)/2)):i=a=NaN),l+=3,s=t>>2,n=(3&t)<<4|i>>4,o=(15&i)<<2|a>>6,r=63&a,isNaN(i)?o=r=64:isNaN(a)&&(r=64),c=c+LZString._keyStr.charAt(s)+LZString._keyStr.charAt(n)+LZString._keyStr.charAt(o)+LZString._keyStr.charAt(r);return c},decompressFromBase64:function(e){if(null==e)return"";var t,i,a,s,n,o,r,c,l="",u=0,p=0,d=LZString._f;e=e.replace(/[^A-Za-z0-9\+\/\=]/g,"");while(p<e.length)n=LZString._keyStr.indexOf(e.charAt(p++)),o=LZString._keyStr.indexOf(e.charAt(p++)),r=LZString._keyStr.indexOf(e.charAt(p++)),c=LZString._keyStr.indexOf(e.charAt(p++)),i=n<<2|o>>4,a=(15&o)<<4|r>>2,s=(3&r)<<6|c,u%2==0?(t=i<<8,64!=r&&(l+=d(t|a)),64!=c&&(t=s<<8)):(l+=d(t|i),64!=r&&(t=a<<8),64!=c&&(l+=d(t|s))),u+=3;return LZString.decompress(l)},compressToUTF16:function(e){if(null==e)return"";var t,i,a,s="",n=0,o=LZString._f;for(e=LZString.compress(e),t=0;t<e.length;t++)switch(i=e.charCodeAt(t),n++){case 0:s+=o(32+(i>>1)),a=(1&i)<<14;break;case 1:s+=o(a+(i>>2)+32),a=(3&i)<<13;break;case 2:s+=o(a+(i>>3)+32),a=(7&i)<<12;break;case 3:s+=o(a+(i>>4)+32),a=(15&i)<<11;break;case 4:s+=o(a+(i>>5)+32),a=(31&i)<<10;break;case 5:s+=o(a+(i>>6)+32),a=(63&i)<<9;break;case 6:s+=o(a+(i>>7)+32),a=(127&i)<<8;break;case 7:s+=o(a+(i>>8)+32),a=(255&i)<<7;break;case 8:s+=o(a+(i>>9)+32),a=(511&i)<<6;break;case 9:s+=o(a+(i>>10)+32),a=(1023&i)<<5;break;case 10:s+=o(a+(i>>11)+32),a=(2047&i)<<4;break;case 11:s+=o(a+(i>>12)+32),a=(4095&i)<<3;break;case 12:s+=o(a+(i>>13)+32),a=(8191&i)<<2;break;case 13:s+=o(a+(i>>14)+32),a=(16383&i)<<1;break;case 14:s+=o(a+(i>>15)+32,32+(32767&i)),n=0;break}return s+o(a+32)},decompressFromUTF16:function(e){if(null==e)return"";var t,i,a="",s=0,n=0,o=LZString._f;while(n<e.length){switch(i=e.charCodeAt(n)-32,s++){case 0:t=i<<1;break;case 1:a+=o(t|i>>14),t=(16383&i)<<2;break;case 2:a+=o(t|i>>13),t=(8191&i)<<3;break;case 3:a+=o(t|i>>12),t=(4095&i)<<4;break;case 4:a+=o(t|i>>11),t=(2047&i)<<5;break;case 5:a+=o(t|i>>10),t=(1023&i)<<6;break;case 6:a+=o(t|i>>9),t=(511&i)<<7;break;case 7:a+=o(t|i>>8),t=(255&i)<<8;break;case 8:a+=o(t|i>>7),t=(127&i)<<9;break;case 9:a+=o(t|i>>6),t=(63&i)<<10;break;case 10:a+=o(t|i>>5),t=(31&i)<<11;break;case 11:a+=o(t|i>>4),t=(15&i)<<12;break;case 12:a+=o(t|i>>3),t=(7&i)<<13;break;case 13:a+=o(t|i>>2),t=(3&i)<<14;break;case 14:a+=o(t|i>>1),t=(1&i)<<15;break;case 15:a+=o(t|i),s=0;break}n++}return LZString.decompress(a)},compressToUint8Array:function(e){for(var t=LZString.compress(e),i=new Uint8Array(2*t.length),a=0,s=t.length;a<s;a++){var n=t.charCodeAt(a);i[2*a]=n>>>8,i[2*a+1]=n%256}return i},decompressFromUint8Array:function(e){if(null===e||void 0===e)return LZString.decompress(e);for(var t=new Array(e.length/2),i=0,a=t.length;i<a;i++)t[i]=256*e[2*i]+e[2*i+1];return LZString.decompress(String.fromCharCode.apply(null,t))},compressToEncodedURIComponent:function(e){return LZString.compressToBase64(e).replace(/=/g,"$").replace(/\//g,"-")},decompressFromEncodedURIComponent:function(e){return e&&(e=e.replace(/$/g,"=").replace(/-/g,"/")),LZString.decompressFromBase64(e)},compress:function(e){if(null==e)return"";var t,i,a,s={},n={},o="",r="",c="",l=2,u=3,p=2,d="",h=0,_=0,f=LZString._f;for(a=0;a<e.length;a+=1)if(o=e.charAt(a),Object.prototype.hasOwnProperty.call(s,o)||(s[o]=u++,n[o]=!0),r=c+o,Object.prototype.hasOwnProperty.call(s,r))c=r;else{if(Object.prototype.hasOwnProperty.call(n,c)){if(c.charCodeAt(0)<256){for(t=0;t<p;t++)h<<=1,15==_?(_=0,d+=f(h),h=0):_++;for(i=c.charCodeAt(0),t=0;t<8;t++)h=h<<1|1&i,15==_?(_=0,d+=f(h),h=0):_++,i>>=1}else{for(i=1,t=0;t<p;t++)h=h<<1|i,15==_?(_=0,d+=f(h),h=0):_++,i=0;for(i=c.charCodeAt(0),t=0;t<16;t++)h=h<<1|1&i,15==_?(_=0,d+=f(h),h=0):_++,i>>=1}l--,0==l&&(l=Math.pow(2,p),p++),delete n[c]}else for(i=s[c],t=0;t<p;t++)h=h<<1|1&i,15==_?(_=0,d+=f(h),h=0):_++,i>>=1;l--,0==l&&(l=Math.pow(2,p),p++),s[r]=u++,c=String(o)}if(""!==c){if(Object.prototype.hasOwnProperty.call(n,c)){if(c.charCodeAt(0)<256){for(t=0;t<p;t++)h<<=1,15==_?(_=0,d+=f(h),h=0):_++;for(i=c.charCodeAt(0),t=0;t<8;t++)h=h<<1|1&i,15==_?(_=0,d+=f(h),h=0):_++,i>>=1}else{for(i=1,t=0;t<p;t++)h=h<<1|i,15==_?(_=0,d+=f(h),h=0):_++,i=0;for(i=c.charCodeAt(0),t=0;t<16;t++)h=h<<1|1&i,15==_?(_=0,d+=f(h),h=0):_++,i>>=1}l--,0==l&&(l=Math.pow(2,p),p++),delete n[c]}else for(i=s[c],t=0;t<p;t++)h=h<<1|1&i,15==_?(_=0,d+=f(h),h=0):_++,i>>=1;l--,0==l&&(l=Math.pow(2,p),p++)}for(i=2,t=0;t<p;t++)h=h<<1|1&i,15==_?(_=0,d+=f(h),h=0):_++,i>>=1;while(1){if(h<<=1,15==_){d+=f(h);break}_++}return d},decompress:function(e){if(null==e)return"";if(""==e)return null;var t,i,a,s,n,o,r,c=[],l=4,u=4,p=3,d="",h="",_=LZString._f,f={string:e,val:e.charCodeAt(0),position:32768,index:1};for(t=0;t<3;t+=1)c[t]=t;a=0,n=Math.pow(2,2),o=1;while(o!=n)s=f.val&f.position,f.position>>=1,0==f.position&&(f.position=32768,f.val=f.string.charCodeAt(f.index++)),a|=(s>0?1:0)*o,o<<=1;switch(a){case 0:a=0,n=Math.pow(2,8),o=1;while(o!=n)s=f.val&f.position,f.position>>=1,0==f.position&&(f.position=32768,f.val=f.string.charCodeAt(f.index++)),a|=(s>0?1:0)*o,o<<=1;r=_(a);break;case 1:a=0,n=Math.pow(2,16),o=1;while(o!=n)s=f.val&f.position,f.position>>=1,0==f.position&&(f.position=32768,f.val=f.string.charCodeAt(f.index++)),a|=(s>0?1:0)*o,o<<=1;r=_(a);break;case 2:return""}c[3]=r,i=h=r;while(1){if(f.index>f.string.length)return"";a=0,n=Math.pow(2,p),o=1;while(o!=n)s=f.val&f.position,f.position>>=1,0==f.position&&(f.position=32768,f.val=f.string.charCodeAt(f.index++)),a|=(s>0?1:0)*o,o<<=1;switch(r=a){case 0:a=0,n=Math.pow(2,8),o=1;while(o!=n)s=f.val&f.position,f.position>>=1,0==f.position&&(f.position=32768,f.val=f.string.charCodeAt(f.index++)),a|=(s>0?1:0)*o,o<<=1;c[u++]=_(a),r=u-1,l--;break;case 1:a=0,n=Math.pow(2,16),o=1;while(o!=n)s=f.val&f.position,f.position>>=1,0==f.position&&(f.position=32768,f.val=f.string.charCodeAt(f.index++)),a|=(s>0?1:0)*o,o<<=1;c[u++]=_(a),r=u-1,l--;break;case 2:return h}if(0==l&&(l=Math.pow(2,p),p++),c[r])d=c[r];else{if(r!==u)return null;d=i+i.charAt(0)}h+=d,c[u++]=i+d.charAt(0),l--,i=d,0==l&&(l=Math.pow(2,p),p++)}}},null!=e&&(e.exports=LZString)}).call(this,i("62e4")(e))},"1b60":function(e,t,i){"use strict";var a=i("5c67"),s=i.n(a);s.a},"1e0c":function(e,t,i){"use strict";var a=i("839c"),s=i.n(a);s.a},"265f":function(e,t,i){},"26d0":function(e,t,i){},"3abb":function(e,t,i){"use strict";var a=i("0714"),s=i.n(a);s.a},"4a9f":function(e,t,i){},"56d7":function(e,t,i){"use strict";i.r(t);i("e260"),i("e6cf"),i("cca6"),i("a79d");var a=i("d30f"),s=(i("4160"),i("c975"),i("b0c0"),i("ac1f"),i("1276"),i("159b"),i("d4ec")),n=i("bee2"),o=(i("a9e3"),function(){function e(){Object(s["a"])(this,e),this.$map=null,this.$mapDrag=null,this.unitSize=0,this.cols=0,this.rows=0,this.ctx=null,this.dragY=!0,this.banPoints=[]}return Object(n["a"])(e,[{key:"init",value:function(e){this.peos=e.peos,this.elements=e.elements,this.enemys=e.enemys,this.$map=e.$map,this.$mapDrag=e.$mapDrag,this.unitSize=e.unitSize,this.cols=e.cols,this.rows=e.rows,this.dragY=void 0==e.dragY,this.$map.width=this.unitSize*this.cols,this.$map.height=this.unitSize*this.rows,this.createMap(),this.$mapDrag&&this.initEvent(this.$mapDrag)}},{key:"createMap",value:function(){this.ctx=this.$map.getContext("2d"),this.ctx.strokeStyle="#555",this.ctx.lineWidth=1;for(var e=0;e<this.cols;e++)this.ctx.beginPath(),this.ctx.moveTo(this.unitSize*e+.5,0),this.ctx.lineTo(this.unitSize*e+.5,this.unitSize*this.rows+.5),this.ctx.stroke();for(var t=0;t<this.rows;t++)this.ctx.beginPath(),this.ctx.moveTo(0,this.unitSize*t+.5),this.ctx.lineTo(this.unitSize*this.cols+.5,this.unitSize*t+.5),this.ctx.stroke();this.ctx.moveTo(0,this.unitSize*this.rows-.5),this.ctx.lineTo(this.unitSize*this.cols-.5,this.unitSize*this.rows-.5),this.ctx.stroke(),this.ctx.moveTo(this.unitSize*this.cols-.5,0),this.ctx.lineTo(this.unitSize*this.cols-.5,this.unitSize*this.rows-.5),this.ctx.stroke()}},{key:"initEvent",value:function(e){var t=this,i=0,a=0,s=function(t){t.stopPropagation(),console.log("dragStart");var s=game.hasTouch?t.touches[0]:t;i=s.pageX-Number(e.style.transform.split("px,")[0].split("(")[1]),a=s.pageY-Number(e.style.transform.split("px,")[1]),e.addEventListener(game.touchMove,n,!1),e.addEventListener(game.touchEnd,o,!1)},n=function(s){var n=game.hasTouch?s.touches[0]:s;s.preventDefault(),t.dragY?e.style.transform="translate3d("+(n.pageX-i)+"px,"+(n.pageY-a)+"px,0px)":e.style.transform="translate3d("+(n.pageX-i)+"px,0px,0px)"},o=function t(i){e.removeEventListener(game.touchStart,t,!1),e.removeEventListener(game.touchMove,n,!1),e.removeEventListener(game.touchEnd,t,!1)};e.addEventListener(game.touchStart,s,!1)}},{key:"drawActionCell",value:function(e,t){for(var i=0;i<this.cols;i++)for(var a=0;a<this.rows;a++)void 0!=e&&-1!=common.indexOf2Array([i,a],e)?this.ctx.fillStyle="moveRange"==t?"#008800":"#FF6600":this.ctx.fillStyle="#000",this.ctx.fillRect(this.unitSize*i+5,this.unitSize*a+5,this.unitSize-10,this.unitSize-10)}},{key:"clearActionCell",value:function(){for(var e=0;e<this.cols;e++)for(var t=0;t<this.rows;t++)this.ctx.clearRect(this.unitSize*e+5,this.unitSize*t+5,this.unitSize-10,this.unitSize-10)}},{key:"clearDraw",value:function(){this.ctx.clearRect(0,0,c.width,c.height)}},{key:"updateBanPoints",value:function(){var e=this;this.banPoints=[],this.peos&&this.peos.forEach((function(t){e.banPoints.push([t.x,t.y])})),this.enemys&&this.enemys.forEach((function(t){e.banPoints.push([t.x,t.y])})),this.elements&&this.elements.forEach((function(t){e.banPoints.push([t.x,t.y])}))}}]),e}()),r=function(){function e(){Object(s["a"])(this,e),this.hasTouch="",this.touchStart="",this.touchMove="",this.touchEnd="",this.saveFiles=[],this.curSave=null,this.packageMaxCount=100,this.peosUpdateCount=8,this.goodsUpdateCount=20,this.battleTempEnemys=[]}return Object(n["a"])(e,[{key:"init",value:function(){var e=/hp-tablet/gi.test(navigator.appVersion);this.hasTouch="ontouchstart"in window&&!e,this.touchStart=this.hasTouch?"touchstart":"mousedown",this.touchMove=this.hasTouch?"touchmove":"mousemove",this.touchEnd=this.hasTouch?"touchend":"mouseup",this.initSaveFiles()}},{key:"initSaveFiles",value:function(){for(var e=0;e<localStorage.length;e++){var t=localStorage.key(e);if(-1!=t.indexOf("myGameSave_File_")){var i=t.split("myGameSave_File_")[1],a=this.load(i);game.saveFiles.push({id:a.id,name:a.name,gameDate:a.gameDate,saveTime:a.saveTime})}}}},{key:"getMaxSaveId",value:function(){var e=0;return game.saveFiles.forEach((function(t){e=t.id>e?t.id:e})),e}},{key:"save",value:function(e,t,i){t.saveTime=(new Date).toLocaleString();var a=this.webStorageKey(e),s=LZString.compressToBase64(JSON.stringify(t));localStorage.setItem(a,s),i&&i()}},{key:"load",value:function(e){var t=this.webStorageKey(e),i=localStorage.getItem(t);return i?JSON.parse(LZString.decompressFromBase64(i)):void console.warn("读取存档失败，找不到id为"+e+"的存档。")}},{key:"removeSave",value:function(e){var t=this.webStorageKey(e);localStorage.removeItem(t)}},{key:"webStorageKey",value:function(e){return e<0?"myGameSave_Config":0===e?"myGameSave_Global":"myGameSave_File_"+e}}]),e}(),l=(i("fd0f"),i("102e"),i("2b0e")),u=i("b970"),p=(i("157a"),i("c59a"),function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{attrs:{id:"app"}},[i("router-view")],1)}),d=[],h={data:function(){return{active:0}},created:function(){if(!game.curSave){if(game.curSave=game.load(1),!game.curSave&&"/"!=this.$route.path)return void this.$router.push("/");this.$store.commit("updateStore")}},mounted:function(){},methods:{},components:{}},_=h,f=(i("5c0b"),i("2877")),m=Object(f["a"])(_,p,d,!1,null,null,null),v=m.exports,g=i("9483");Object(g["a"])("".concat("","service-worker.js"),{ready:function(){console.log("App is being served from cache by a service worker.\nFor more details, visit https://goo.gl/AFskqB")},registered:function(){g["a"].update(),console.log("Service worker has been registered.")},cached:function(){console.log("Content has been cached for offline use.")},updatefound:function(){console.log("New content is downloading.")},updated:function(){console.log("New content is available; please refresh.")},offline:function(){console.log("No internet connection found. App is running in offline mode.")},error:function(e){console.error("Error during service worker registration:",e)}});var y=i("8c4f"),b=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{attrs:{id:"home"}},[i("div",{staticClass:"tree"},[i("Tree",{ref:"tree",attrs:{myTeam:e.myTeam,nodes:e.nodes}})],1),i("HeaderBar"),i("FooterNav")],1)},k=[],w=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("ul",e._l(e.nodes,(function(t){return i("li",{key:t.id,class:t.type,attrs:{id:"node-"+t.id}},[i("a",{class:"state-"+t.state,on:{touchend:function(i){return i.preventDefault(),i.stopPropagation(),e.click_node(t)}}},[i("i",{class:"iconfont icon-"+["camp","battle","event"][t.type]}),i("span",{staticClass:"size"},e._l(t.size,(function(e){return i("van-icon",{attrs:{name:"star"}})})),1)]),t.children&&t.children.length>0?i("Tree",{attrs:{nodes:t.children,myTeam:e.myTeam}}):e._e()],1)})),0)},S=[],x=(i("7db0"),i("5924")),E={name:"Tree",props:["nodes","myTeam"],data:function(){return{}},methods:{click_node:function(e){var t=this;game.curSave.curNodeId!=e.id&&(this.$store.commit("change_targetNode",e),this.showDialog(e,(function(){if(game.curSave.myTeam.forEach((function(e){e.dates++})),1!=e.state)switch(e.type){case 2:t.updateCurNode(e),t.createNodes(e);break;case 1:if(0==game.curSave.myTeam.length)return void t.$toast.fail("请先招募队员");t.$router.push("/battle");break;default:t.updateCurNode(e),t.createNodes(e);break}else t.updateCurNode(e)})))},showDialog:function(e,t){this.$dialog.confirm({title:"移动到"+e.id,message:["营地","战场","事件"][e.type]+" ["+["未探索","已探索","当前"][e.state]+"]，规模 ["+e.size+"]"}).then((function(){t&&t()})).catch((function(){}))},updateCurNode:function(e){this.recoveryHp();var t=Object(x["c"])(game.curSave.curNodeId,game.curSave.nodes);console.log(t,e),t.state=1,e.state=2,game.curSave.curNodeId=e.id,game.curSave.date++,this.$store.commit("updateStore")},recoveryHp:function(){console.log(this.myTeam),this.myTeam.forEach((function(e){e.hp+=Math.round(.3*e.hpMax),e.hp=e.hp>e.hpMax?e.hpMax:e.hp;var t=game.curSave.myTeam.find((function(t){return t.id==e.id}));t.hp=e.hp,t.hp=t.hp>t.hpMax?t.hpMax:t.hp}))},createNodes:function(e,t){t=void 0==t?common.random(1,3):t;for(var i=0;i<t;i++){var a=common.getNumberInAppoint([[0,.1],[1,.7],[2,.2]]);e.children.push(this.createNode(a,0,e.depth+1,e.index,i))}},createNode:function(e,t,i,a,s){return{id:i+"-"+a+"-"+s,depth:i,index:s,type:e,state:t,size:common.getNumberInAppoint([[1,.1],[2,.2],[3,.4],[4,.2],[5,.1]]),children:[]}}}},C=E,P=(i("ff13"),Object(f["a"])(C,w,S,!1,null,null,null)),O=P.exports,I=(i("99af"),i("c740"),i("a434"),function(){function e(){Object(s["a"])(this,e)}return Object(n["a"])(e,[{key:"start",value:function(e,t,i,a,s){var n=document.getElementById("animateMask");switch(n.style.display="block",i.id){case-1:this.moveTo(e,t,a,s);break;case 99:this.end(e,t,a,s);break;case 18:this.shield(e,"down",s);break;case 17:this.shield(e,"up",s);break;case 13:this.whirlwind(e,t,a,s);break;case 9:this.attack(e,t,a,s);break;case 6:this.attack(e,t,a,s);break;default:this.attack(e,t,a,s);break}}},{key:"whirlwind",value:function(e,t,i,a){var s=500,n=document.getElementById(e.id);n.style.transition=s+"ms",n.style.transform="rotate(350deg)",setTimeout((function(){n.style.transition="0ms",n.style.transform="",a()}),s)}},{key:"end",value:function(e,t,i,a){var s=500;setTimeout((function(){a()}),s)}},{key:"moveTo",value:function(e,t,i,a){console.log(t);var s=500,n=document.getElementById(e.id);n.style.transition=s+"ms",n.style.left="".concat(t[0]*i.unitSize,"px"),n.style.top="".concat(t[1]*i.unitSize,"px"),setTimeout((function(){a()}),s)}},{key:"shield",value:function(e,t,i){var a=500,s=document.getElementById(e.id),n=s.querySelector(".rightHand"),o="up"==t?-10:0;n.style.transition=a+"ms",n.style.transform="translate3d(0,".concat(o,"px,0)"),setTimeout((function(){i()}),a)}},{key:"attack",value:function(e,t,i,a){var s=250,n=document.getElementById(e.id);n.style.transition=s+"ms",n.style.left="".concat(t[0]*i.unitSize,"px"),n.style.top="".concat(t[1]*i.unitSize,"px"),setTimeout((function(){n.style.left="".concat(e.x*i.unitSize,"px"),n.style.top="".concat(e.y*i.unitSize,"px"),setTimeout(a,s)}),s)}},{key:"attacked",value:function(e,t,i,a,s){var n=document.getElementById(t.id),o=n.querySelector(".stateDes"),r="",c=800;if(0==a.type){r="MISS";var l=50;n.style.transition=l+"ms",n.style.transform="translate3d(-10px,0,0)",setTimeout((function(){n.style.transform="translate3d(10px,0,0)",setTimeout((function(){n.style.transform=""}),l)}),2*l)}else if("rightHand"==a.position){r="-"+a.equipDamage+"盾";var u=n.querySelector(".rightHand"),p=u.style.transform;u.style.transition="200ms",u.style.transform=p+" scale(1.5,1.5)",t._equips.rightHand.dur<=0?setTimeout((function(){u.style.transform=p+" scale(1,0)",setTimeout((function(){t.removeSkill(18,!0),t.removeEquip("rightHand")}),200)}),400):setTimeout((function(){u.style.transform=p+" scale(1,1)"}),400)}else r="-"+a.damage+("head"==a.position?"！":""),2==a.type&&(n.style.transition="800ms",n.style.opacity=0,n.style.transform="scale(1,0)");o.innerText=r,o.style.transition=c+"ms",o.style.transform="translate3d(0,-30px,0)",o.style.opacity=1,setTimeout((function(){o.style.transition="0ms",o.style.transform="translate3d(0,0,0)",o.style.opacity=0,s()}),c)}}]),e}()),q=new I,M=function(){function e(){Object(s["a"])(this,e)}return Object(n["a"])(e,[{key:"init",value:function(e,t,i,a,s){this._type=e,this._map=t,this._peos=i,this._elements=a,this._enemys=s,this._ap=6,this._state="waiting",this._moveRange=[],this._actionRange=[],this._damages=0,this._dodges=0,this._hits=0,this._hhs=0,this._kills=0,this._exp=0,this._level=0,this.initAbility(),this._buffs=[],this.initBuffs_(),this._skills=[],this.initSkills_(),this._equips={head:void 0,other:void 0,body:void 0,leftHand:void 0,rightHand:void 0},this.initEquips_(),this.updateAbility()}},{key:"initAbility",value:function(){var e=this,t="our"==this._type?game.curSave.myTeam:game.battleTempEnemys,i=t.find((function(t){return t.id==e.id}));this.hpMax=i.hpMax,this.pow=i.pow,this.agi=i.agi,this.skill=i.skill,this.luck=i.luck,this.will=i.will,this.endu=i.endu,this.move=i.move,this.atk=0,this.hit=0,this.dod=0,this.atkb=0,this.fatkb=0,this.hh=0,this.hhb=0,this.mor=0,this.bh=0,this.ba=0,this.pa=0,this.bs=0}},{key:"doAction",value:function(e,t,i){var a=this;if(console.log("【"+this.name+"】",this,"对目标",e,"执行","【"+t.type+"】",t),this._ap<t.ap)console.log("ap不足");else{var s=[];if(-1==t.id||99==t.id)q.start(this,e,t,this._map,(function(){a._ap=a._ap-t.ap,a.doOneAction(e,null,t),a.animateCallBack(i)}));else{var n=Object(x["d"])("skillRange",t.rangeID),o=Object(x["g"])(e,n,this._map,this);if(console.log("技能执行范围：",o),s=Object(x["h"])(this,o,t,this._peos,this._elements,this._enemys),console.log("技能执行范围内能实施的单位数组：",s),0==s.length)return;q.start(this,e,t,this._map,(function(){a._ap=a._ap-t.ap,s.forEach((function(n,o){var r=a.doOneAction(e,n,t);r?q.attacked(a,n,a._map,r,(function(){o==s.length-1&&a.animateCallBack(i)})):a.animateCallBack(i)}))}))}this._map.clearActionCell()}}},{key:"animateCallBack",value:function(e){this.cancle();var t=document.getElementById("animateMask");t.style.display="none",e&&e()}},{key:"doOneAction",value:function(e,t,i){var a=this;switch(i.id){case-1:this.action_moveTo(e);break;case 99:this.action_end();break;case 18:i.buffs.forEach((function(e){a.removeBuff(e)})),this.removeSkill(18),this.addSkill(17);break;case 17:i.buffs.forEach((function(e){a.addBuff(e)})),this.removeSkill(17),this.addSkill(18);break;case 13:return this.action_attack(t);case 9:this.action_pull(t);break;case 6:this.action_push(t);break;default:return this.action_attack(t)}}},{key:"action_pull",value:function(e){var t=(this.x+e.x)/2,i=(this.y+e.y)/2;-1!=common.indexOf2Array([t,i],this._map.banPoints)?e.addBuff(1):(e.x=t,e.y=i,this._map.updateBanPoints())}},{key:"action_push",value:function(e){var t=2*e.x-this.x,i=2*e.y-this.y;t<0||t>this._map.cols||i<0||i>this._map.rows||-1!=common.indexOf2Array([t,i],this._map.banPoints)?e.addBuff(1):(e.x=t,e.y=i,this._map.updateBanPoints())}},{key:"action_attack",value:function(e){if(-1!=e.buffs.indexOf(0))return this.attackAccount(e,"rightHand");var t=this.hit-e.dod;t=t>100?100:t;var i=common.random(1,100),a=i<=t;if(console.log("【".concat(this.name,"】攻击【").concat(e.name,"】,【").concat(t,",").concat(i,"】,").concat(a?"命中":"miss")),!a)return e._dodges++,{type:0,position:"",damage:0,equipDamage:0};var s=this.hh+e.hhb;s=s>100?100:s;var n=common.random(1,100),o=n<=s;return this.attackAccount(e,o?"head":"body")}},{key:"attackAccount",value:function(e,t){var i=this._equips["leftHand"],a=e._equips[t],s=0,n=0,o="head"==t?1.5:1;if(i)if("rightHand"==t)n=this.atk*this.ba/100;else{var r=a?this.pa:100;r=r>100?100:r,s=this.atk*this.pa*o/100,n=a?this.atk*this.ba/100:0}else s=1*o,n=a?2:0;return s=Math.round(s),n=Math.round(n),e.hp-=s,e.hp=e.hp<0?0:e.hp,a&&(a.dur-=n,a.dur=a.dur<0?0:a.dur),console.log("命中【".concat(t,"】，hp：-").concat(s,"，装备：-").concat(n)),e.hp<=0&&console.log("【"+this.name+"】",this,"击杀了","【"+e.name+"】",e),this._hits++,this._damages=this._damages+s+n,this._hhs=this._hhs+("head"==t?1:0),this._kills=this.kills+(e.hp<=0?1:0),{type:e.hp<=0?2:1,position:t,damage:s,equipDamage:n}}},{key:"action_end",value:function(){this._state="end"}},{key:"action_moveTo",value:function(e){this._state="moving",this.x=e[0],this.y=e[1],this._map.updateBanPoints()}},{key:"initSkills_",value:function(){var e=this;this.skills.forEach((function(t){e.addSkill(t)}))}},{key:"initBuffs_",value:function(){var e=this;this.buffs.forEach((function(t){e.addBuff(t)}))}},{key:"initEquips_",value:function(){for(var e in this.equip)this.addEquip(e,common.getGoods(this.equip[e],"myGoods"))}},{key:"switchEquip",value:function(e,t,i){this.removeEquip(e),this.addEquip(e,i)}},{key:"addEquip",value:function(e,t){var i=this;t&&(t.skills.forEach((function(e){i.addSkill(e)})),this.equip[e]=t.id),this._equips[e]=t,this.updateAbility()}},{key:"removeEquip",value:function(e){var t=this,i=this._equips[e];i&&i.skills.forEach((function(e){t.removeSkill(e,!0)})),this.equip[e]="",this._equips[e]=void 0,this.updateAbility()}},{key:"addSkill",value:function(e){var t=this,i=Object(x["d"])("skills",e);i&&0==i.active&&i.buffs.forEach((function(e){t.addBuff(e)})),this.addItem("skills",e),this.updateAbility()}},{key:"removeSkill",value:function(e,t){var i=this,a=this._skills.find((function(t){return t.id==e}));a&&(t||0==a.active)&&a.buffs.forEach((function(e){i.removeBuff(e)})),this.removeItem("skills",e),this.updateAbility()}},{key:"addBuff",value:function(e){this.addItem("buffs",e),this.updateAbility()}},{key:"removeBuff",value:function(e){this.removeItem("buffs",e),this.updateAbility()}},{key:"checkBuffs",value:function(){var e=this;this._buffs.forEach((function(t){if("time"==t.roundUnit&&t.round>0){switch(t.id){case 1:e.action_end();break}t.round--,t.round<=0&&e.removeBuff(t.id)}}))}},{key:"addItem",value:function(e,t){var i=this[e].indexOf(t),a=this["_"+e].findIndex((function(e){return e.id==t}));if(-1==i&&this[e].push(t),-1==a&&this["_"+e].push(Object(x["d"])(e,t)),-1!=a&&"buffs"==e){var s=Object(x["d"])("buffs",t),n=this._buffs.find((function(e){return e.id==t}));n.round=s.round}}},{key:"removeItem",value:function(e,t){var i=this[e].indexOf(t);-1!=i&&this[e].splice(i,1);var a=this["_"+e].findIndex((function(e){return e.id==t}));-1!=a&&this["_"+e].splice(a,1)}},{key:"updateAbility",value:function(e){var t=this;for(var i in this.initAbility(),this._equips){var a=this._equips[i];a&&("leftHand"==i&&this.setAbility(a,"leftHand"),this.setAbility(a.effect))}e&&this.setAbility(e.effect),this._buffs.forEach((function(e){t.setAbility(e.effect)})),this._skills.sort((function(e,t){return e.id-t.id})),this._buffs.sort((function(e,t){return e.id-t.id})),this.atk+=this.pow,this.hit+=this.agi,this.dod+=this.agi,this.atkb+=this.skill,this.fatkb+=Math.round(this.skill/2),this.mor+=this.will,this.hit+=80,this.mor+=100}},{key:"setAbility",value:function(e,t){if("leftHand"==t)this.atk=e.atk,this.bh=e.bh,this.ba=e.ba,this.pa=e.pa,this.bs=e.bs,this.hit=e.hit,this.hh=e.hh;else for(var i in e)void 0!=this[i]&&(this[i]+=e[i],"hpMax"==i&&this.hp==this.hpMax&&(this.hp+=e.hpMax))}},{key:"getLevel",value:function(){for(var e=this.exp,t=20,i=0;i<data.exp.length;i++)if(e-=data.exp[i],e<0){t=i-1;break}return t}},{key:"addSkillPoint",value:function(e){e>10||this.skillPoints++}},{key:"addLevelPoint",value:function(e){var t={},i=function(t){if(e>10)return 1;switch(t){case 0:return common.random(1,2);case 1:return common.random(1,3);case 2:return common.random(2,3);case 3:return common.random(2,4)}};for(var a in this.poten)t[a]=i(this.poten[a]);this.levelPoints++,this.potenUp.push(t),i=null}},{key:"getRoundPoints",value:function(e){var t=e[0],i=e[1],a=[];return i-1>=0&&a.push([t,i-1]),t-1>=0&&a.push([t-1,i]),t+1<this._map.cols&&a.push([t+1,i]),i+1<this._map.rows&&a.push([t,i+1]),a}},{key:"getMoveRange",value:function(){var e=this,t=[],i=function(a,s){for(var n=e.getRoundPoints(a),o=0;o<n.length;o++){var r=s,c=n[o];-1==common.indexOf2Array(c,e._map.banPoints)&&(r--,-1==common.indexOf2Array(c,t)&&t.push(c),r>0&&i(c,r))}};return i([this.x,this.y],this.move),i=null,t}},{key:"creatSkillRange",value:function(e){this._state="actionRange";var t=Object(x["d"])("skillRange",e.rangeID),i=Object(x["e"])([this.x,this.y],t.effective,this._map);this._actionRange=i,this._map.drawActionCell(this._actionRange,"skillRange")}},{key:"creatMoveRange",value:function(){this._state="moveRange",this._moveRange=this.getMoveRange(),this._map.drawActionCell(this._moveRange,"moveRange")}},{key:"resetStatus",value:function(){this._state="waiting",this._ap=6}},{key:"cancle",value:function(){this._state="end"==this._state?"end":"waiting",this.updateAbility(),this._map.clearActionCell(),this._moveRange=[],this._actionRange=[]}}]),e}(),D={components:{Tree:O},data:function(){return{nodes:game.curSave.nodes,myTeam:[]}},created:function(){var e=this;game.curSave.myTeam.forEach((function(t){var i=JSON.parse(JSON.stringify(t));i.__proto__=new M,i.init("our"),e.myTeam.push(i)})),console.log(this.myTeam)},mounted:function(){this.winner=this.$route.params.winner,1==this.winner&&(this.$refs.tree.updateCurNode(this.$store.state.targetNode),this.$refs.tree.createNodes(this.$store.state.targetNode))},methods:{}},T=D,A=Object(f["a"])(T,b,k,!1,null,null,null),B=A.exports,N=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"battle",attrs:{components:"Battle"}},[i("div",{staticClass:"topBar",class:e.round%2==0?"enemyRound":""},[i("span",{staticClass:"round"},[e._v("第"+e._s(e.round)+"回合 [ "+e._s(e.round%2==0?"敌方":"我方")+" ]")])]),e.curPeo?i("PeoStatus",{attrs:{peo:e.curPeo}}):e._e(),i("div",{attrs:{id:"mapWrap"}},[i("div",{staticStyle:{transform:"translate3d(0px,0px,0px)"},attrs:{id:"mapDrag"}},[i("div",{attrs:{id:"mapIn"}},[i("canvas",{attrs:{id:"map"}}),i("ul",{staticClass:"elements"},e._l(e.elements,(function(t){return i("li",{key:t.id,style:{width:e.unitSize+"px",height:e.unitSize+"px",left:e.unitSize*t.x+"px",top:e.unitSize*t.y+"px",fontSize:e.unitSize+"px",lineHeight:e.unitSize+"px"},attrs:{id:t.id}},[i("i",{class:["iconfont","icon-map-ele-"+t.type]})])})),0),i("ul",{staticClass:"peos enemys"},e._l(e.enemys,(function(t){return i("li",{key:t.id,class:[e.curPeo==t?"active":"","end"==t._state?"end":""],style:{width:e.unitSize+"px",height:e.unitSize+"px",left:e.unitSize*t.x+"px",top:e.unitSize*t.y+"px"},attrs:{id:t.id}},[i("Peo",{style:{fontSize:e.unitSize+"px",lineHeight:e.unitSize-8+"px"},attrs:{peo:t}}),e.curPeo&&-1!=e.common.indexOf2Array([t.x,t.y],e.curPeo._actionRange)?i("span",{staticClass:"hit"},[e._v(e._s(e.curPeo.hit-t.dod+"%"))]):e._e()],1)})),0),i("ul",{staticClass:"peos myTeam"},e._l(e.peos,(function(t){return i("li",{key:t.id,class:[e.curPeo==t?"active":"","end"==t._state?"end":""],style:{width:e.unitSize+"px",height:e.unitSize+"px",left:e.unitSize*t.x+"px",top:e.unitSize*t.y+"px"},attrs:{id:t.id}},[i("Peo",{style:{fontSize:e.unitSize+"px",lineHeight:e.unitSize-8+"px"},attrs:{peo:t}})],1)})),0),i("section",{attrs:{id:"mapMask"},on:{touchstart:function(t){return t.stopPropagation(),e.click_map(t)}}})])])]),i("div",{staticClass:"skills"},[e.curPeo?i("ul",e._l(e.curPeo._skills,(function(t){return i("li",{key:t.id,class:e.curSkill==t?"cur":"",style:{width:e.unitSize+"px",height:e.unitSize+"px",fontSize:e.unitSize+"px",lineHeight:e.unitSize+"px"},on:{click:function(i){return e.click_skill(t)}}},[i("div",{class:["in","end"==e.curPeo._state||e.curPeo._ap<t.ap?"disabled":""]},[i("span",{staticClass:"peoAP"},e._l(t.ap,(function(e){return i("i",[i("s")])})),0),i("span",{staticClass:"name"},[e._v(e._s(t.type))])])])})),0):e._e()]),i("BottomBtns",{attrs:{curPeo:e.curPeo,round:e.round},on:{click_cancle:e.click_cancle,click_end:e.click_end}}),i("FooterNav"),i("div",{attrs:{id:"animateMask"}})],1)},j=[],$=(i("d81d"),function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("section",{staticClass:"peo",attrs:{component:"Peo"}},[i("ul",{staticClass:"lines"},[i("li",{staticClass:"item"},[i("span",{staticClass:"line hp"},[i("i",{style:{width:e.hpPerc+"%"}})])]),i("li",{staticClass:"item"},[i("span",{staticClass:"line dur"},[i("i",{style:{width:e.headPerc+"%"}})])]),i("li",{staticClass:"item"},[i("span",{staticClass:"line dur"},[i("i",{style:{width:e.bodyPerc+"%"}})])])]),e.peo._equips?i("span",{staticClass:"equips"},[e.peo._equips.body?i("i",{class:["body","iconfont","icon-"+e.data.goods.find((function(t){return t.id==e.peo._equips.body.type})).icon]}):e._e(),e.peo._equips.leftHand?i("i",{class:["leftHand","iconfont","icon-"+e.data.goods.find((function(t){return t.id==e.peo._equips.leftHand.type})).icon]}):e._e(),e.peo._equips.rightHand?i("i",{class:["rightHand","iconfont","icon-"+e.data.goods.find((function(t){return t.id==e.peo._equips.rightHand.type})).icon]}):e._e()]):e._e(),i("div",{staticClass:"name"},[e._v(e._s(e.peo.name))]),i("span",{staticClass:"peoAP"},e._l(6,(function(t){return i("i",[i("s",{directives:[{name:"show",rawName:"v-show",value:t<=e.peo._ap,expression:"i<=peo._ap"}]})])})),0),i("div",{staticClass:"mask"}),i("span",{staticClass:"stateDes"})])}),R=[],L={data:function(){return{hpPerc:0,headPerc:0,bodyPerc:0,stateTimer:null}},props:["peo"],watch:{peo:{handler:function(e,t){this.update()},deep:!0}},mounted:function(){this.update()},methods:{update:function(){this.hpPerc=Math.round(this.peo.hp/this.peo.hpMax*100),this.headPerc=this.peo._equips&&this.peo._equips.head?Math.round(this.peo._equips.head.dur/this.peo._equips.head.durMax*100):0,this.bodyPerc=this.peo._equips&&this.peo._equips.body?Math.round(this.peo._equips.body.dur/this.peo._equips.body.durMax*100):0}},beforeDestroy:function(){clearTimeout(this.stateTimer)}},U=L,z=(i("0eb2"),Object(f["a"])(U,$,R,!1,null,null,null)),K=z.exports,F=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"btns"},[i("van-button",{directives:[{name:"show",rawName:"v-show",value:e.curPeo,expression:"curPeo"}],attrs:{type:"default",size:"small"},on:{click:e.click_cancle}},[e._v("取消")]),i("van-button",{directives:[{name:"show",rawName:"v-show",value:e.round%2!=0,expression:"round%2!=0"}],attrs:{type:"default",size:"small"},on:{click:e.click_end}},[e._v("结束")]),i("van-button",{attrs:{type:"default",size:"small"},on:{click:e.click_menu}},[e._v("菜单")]),i("van-action-sheet",{attrs:{actions:e.actions,"cancel-text":"取消"},on:{select:e.onSelect},model:{value:e.showOption,callback:function(t){e.showOption=t},expression:"showOption"}})],1)},W=[],H={props:["curPeo","round"],data:function(){return{active:0,showOption:!1,actions:[{name:"撤退"},{name:"开始菜单"}]}},methods:{click_cancle:function(){this.$emit("click_cancle")},click_end:function(){var e=this;this.$dialog.confirm({message:"结束回合"}).then((function(){e.$emit("click_end")})).catch((function(){}))},click_menu:function(){this.showOption=!0},onSelect:function(e){var t=this;switch(e.name){case"撤退":this.$dialog.confirm({message:"确定撤退吗？"}).then((function(){t.$router.push("/home")})).catch((function(){}));break;case"开始菜单":this.$dialog.confirm({message:"确定返回开始菜单？"}).then((function(){t.$router.push("/")})).catch((function(){}));break}}}},G=H,Z=(i("1e0c"),Object(f["a"])(G,F,W,!1,null,"2bf78046",null)),J=Z.exports,V=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"PeoStatus"},[i("div",{staticClass:"infoTop"},[i("span",{staticClass:"pull-right lv"},[e._v("LV"),i("strong",[e._v(e._s(e.peo.level))])]),i("span",{staticClass:"name"},[e._v(e._s(e.peo.name)),i("i",[e._v("["+e._s(e.common.getTypeName("peos",e.peo.type))+"]")])])]),i("ul",{staticClass:"lines"},[i("li",{staticClass:"item"},[e._v(" 生命："),i("span",{staticClass:"line hp"},[i("i",{style:{width:e.hpPerc+"%"}}),i("b",[e._v(e._s(e.peo.hp+"/"+e.peo.hpMax))])])]),i("li",{staticClass:"item"},[e._v(" 头盔："),i("span",{staticClass:"line dur"},[i("i",{style:{width:e.headPerc+"%"}}),i("b",[e._v(e._s(e.headData))])])]),i("li",{staticClass:"item"},[e._v(" 盔甲："),i("span",{staticClass:"line dur"},[i("i",{style:{width:e.bodyPerc+"%"}}),i("b",[e._v(e._s(e.bodyData))])])])]),i("div",{staticClass:"buffs"},e._l(e.peo._buffs,(function(t){return i("van-tag",{key:t.id,attrs:{type:"success"}},[e._v(" "+e._s(t.type)+" ")])})),1)])},Y=[],X={props:["peo"],data:function(){return{hpPerc:0,headPerc:0,headData:"0/0",bodyPerc:0,bodyData:"0/0"}},mounted:function(){this.update()},watch:{peo:{handler:function(e,t){this.update()},deep:!0}},methods:{update:function(){this.hpPerc=Math.round(this.peo.hp/this.peo.hpMax*100),this.headPerc=this.peo._equips.head?Math.round(this.peo._equips.head.dur/this.peo._equips.head.durMax*100):0,this.headData=this.peo._equips.head?this.peo._equips.head.dur+"/"+this.peo._equips.head.durMax:"0/0",this.bodyPerc=this.peo._equips.body?Math.round(this.peo._equips.body.dur/this.peo._equips.body.durMax*100):0,this.bodyData=this.peo._equips.body?this.peo._equips.body.dur+"/"+this.peo._equips.body.durMax:"0/0"}}},Q=X,ee=(i("1b60"),Object(f["a"])(Q,V,Y,!1,null,null,null)),te=ee.exports,ie=(i("a4d3"),i("e01a"),i("d28b"),i("d3b7"),i("3ca3"),i("ddb0"),function(){function e(t){Object(s["a"])(this,e),this.enemys=t.enemys,this.peos=t.peos,this.elements=t.elements,this.map=t.map,this.tree=[],this.skills=[]}return Object(n["a"])(e,[{key:"start",value:function(e,t,i){var a=this;if("end"!=e._state){console.time("AI生成决策树耗时"),this.tree=[],console.log(e,e.name,"开始行动"),console.log("初始位置",[e.x,e.y]),e._skills.forEach((function(t){a.createLeaf(e,t)})),this.tree.sort((function(e,t){return t.score-e.score})),console.warn(e.name,"AI生成决策树",this.tree),console.timeEnd("AI生成决策树耗时");var s=this.getRandomAction(this.tree);e.doAction(s.point,s.skill,(function(){t()||("end"==e._state?i&&i():a.start(e,t,i))}))}else i&&i()}},{key:"createLeaf",value:function(e,t){var i=this;if(!(e._ap<t.ap)){var a={};if(-1==t.id){t.move;var s=e.getMoveRange(),n=this.getNearestEnemy(e),o=this.getDistance([e.x,e.y],[n.x,n.y]),r=!0,c=!1,l=void 0;try{for(var u,p=s[Symbol.iterator]();!(r=(u=p.next()).done);r=!0){var d=u.value,h=this.getMoveScore(e,d,n,o);a=this.createAction(t,d,h),this.tree.push(a)}}catch(m){c=!0,l=m}finally{try{r||null==p.return||p.return()}finally{if(c)throw l}}}else if(99!=t.id){var _=Object(x["d"])("skillRange",t.rangeID),f=Object(x["e"])([e.x,e.y],_.effective,this.map);f.forEach((function(s){var n=Object(x["g"])(s,_,i.map,e),o=Object(x["h"])(e,n,t,i.peos,i.elements,i.enemys);if(0!=o.length){var r=i.getActionScore(e,s,o,t);a=i.createAction(t,s,r),i.tree.push(a)}}))}else a=this.createAction(t,[e.x,e.y],0),this.tree.push(a)}}},{key:"getActionScore",value:function(e,t,i,a){var s=this,n=0;if(1==a.account)i.forEach((function(t){n+=s.getEstimateOneScore(e,t,a)}));else switch(a.id){case 17:n=10;break;case 18:n=0;break;default:break}return n}},{key:"getEstimateOneScore",value:function(e,t,i){console.log("人员：",e,"目标：",t,"技能：",i);var a={bh:0,ba:0,pa:0,bs:0};if(!e._equips.leftHand)return a.pa=1,a.bh=1,a.ba=1,a.bs=1,a.pa;var s=this.getOnePaDamage(e,t,i,"head"),n=this.getOnePaDamage(e,t,i,"body");console.log("预期穿甲伤害，头/身",s,n);var o=s>n?s:n;return a.pa=o/t.hp*100,console.log("预期单个分数：",a.pa),a.pa}},{key:"getOnePaDamage",value:function(e,t,i,a){var s=0,n=e.atk,o=t._equips[a]?e._equips.leftHand.pa:100;o=(i.effect.pa?o+i.effect.pa:o)/100,o=o>1?1:o,n=i.effect.atk?n+i.effect.atk:n;var r=e.hit-t.dod;r=(i.effect.hit?r+i.effect.hit:r)/100,r=r>1?1:r;var c=e.hh-t.hhb;return c=(i.effect.hh?c+i.effect.hh:c)/100,c=c>1?1:c,s=Math.round(n*o*r*("body"==a?1-c:c)*("body"==a?1:1.5)),s}},{key:"getMoveScore",value:function(e,t,i,a){var s=0,n=this.getDistance(t,[i.x,i.y]);s=a-n;var o=this.getRoundEnemys(e);return o.length>0&&(s+=-25*o.length),s}},{key:"getRandomAction",value:function(e){for(var t=0,i=[],a=0;a<e.length;a++){if(a>2||e[a].score<0)break;t+=e[a].score}if(0==t)return console.log("决策树中前3个决策总分为0，返回第一个决策",0),e[0];for(a=0;a<e.length;a++){if(a>2||e[a].score<0)break;i.push([a,e[a].score/t])}var s=common.getNumberInAppoint(i);return console.log("决策树中前3个决策概率/随机结果",i,s),e[s]}},{key:"getNearestEnemy",value:function(e){var t=this,i=null,a=999999;return this.peos.forEach((function(s){var n=t.getDistance([e.x,e.y],[s.x,s.y]);n<=a&&(a=n,i=s)})),i}},{key:"getDistance",value:function(e,t){return Math.abs(e[0]-t[0])+Math.abs(e[1]-t[1])}},{key:"getRoundEnemys",value:function(e){var t=[],i=e.getRoundPoints([e.x,e.y]);return this.peos.forEach((function(e){common.indexOf2Array([e.x,e.y],i)})),t}},{key:"createAction",value:function(e,t,i){return{skillName:e.type,skill:e,point:t,score:i}}}]),e}()),ae={components:{Peo:K,PeoStatus:te,BottomBtns:J},data:function(){return{peos:[],enemys:[],elements:[],curPeo:null,unitSize:0,skills:[],curSkill:null,round:0}},created:function(){this.tempPeos=[],this.tempEnemys=[],this.mapDiv=9,this.mapSize={xMax:this.mapDiv-1,yMax:this.mapDiv-1},this.map=new o,this.initPeos(),this.initEnemys(),this.initElements()},mounted:function(){this.$map=document.getElementById("map"),this.initMap(),this.AI=new ie({enemys:this.enemys,peos:this.peos,elements:this.elements,map:this.map}),this.nextRound()},methods:{click_skill:function(e){this.curPeo.cancle(),"end"==this.curPeo._state||this.curPeo._ap<e.ap||(this.curSkill=e,this.curPeo.updateAbility(e),-1==e.id?this.curPeo.creatMoveRange():0==e.rangeID?this.curPeo.doAction([this.curPeo.x,this.curPeo.y],this.curSkill,this.actionCallBack):this.curPeo.creatSkillRange(e))},click_map:function(e){if(this.round%2!=0){var t=common.getMapPoint(e,this.unitSize,document.getElementById("mapWrap")),i=Object(x["f"])(t,this.peos,this.elements,this.enemys);if(console.log("点击坐标：",t,"坐标单位：",i),this.curPeo)if("moveRange"==this.curPeo._state)if(-1!=common.indexOf2Array(t,this.curPeo._moveRange)){if("enemy"==this.curPeo._type)return;this.curPeo.doAction(t,this.curSkill,this.actionCallBack)}else this.checkUnit(i);else if(-1!=common.indexOf2Array(t,this.curPeo._actionRange)){if("enemy"==this.curPeo._type)return;this.curPeo.doAction(t,this.curSkill,this.actionCallBack)}else this.checkUnit(i);else this.checkUnit(i)}},actionCallBack:function(){this.curSkill=null,this.isGameOver()||(this.setEnd(this.peos),this.isRoundEnd(this.peos)&&this.nextRound())},setEnd:function(e){e.forEach((function(e){for(var t=!0,i=0;i<e._skills.length-1;i++)if(e._ap>0&&e._skills[i].ap<=e._ap){t=!1;break}e._state=t?"end":e._state}))},removeDieUnit:function(e){for(var t=e.length-1;t>=0;t--)e[t].hp<=0&&(e.splice(t,1),this.map.updateBanPoints(this.peos,this.elements,this.enemys))},isGameOver:function(){var e=this;if(this.removeDieUnit(this.peos),this.removeDieUnit(this.enemys),!(this.peos.length>0&&this.enemys.length>0)){var t=0==this.peos.length?2:1,i=1==t?"战斗结束，我方胜利":"战斗结束，我方失败";return this.$dialog.alert({message:i}).then((function(){e.$router.push({name:"BattleEnd",params:{winner:t,peos:e.tempPeos,enemys:e.tempEnemys}})})),!0}},checkUnit:function(e){e?this.click_unit(e):this.click_cancle()},click_unit:function(e){"our"==e._type||"enemy"==e._type?(this.curPeo=e,this.click_skill(this.curPeo._skills[0])):this.click_cancle()},initPeos:function(){var e=this;game.curSave.myTeam.forEach((function(t){var i=JSON.parse(JSON.stringify(t));i.__proto__=new M,i.init("our",e.map,e.peos,e.elements,e.enemys),e.peos.push(i),e.tempPeos.push(i)})),console.log("我方",this.peos),this.putPeos("myTeam")},initEnemys:function(){var e=this.$store.state.targetNode.size;game.battleTempEnemys=[],console.log("据点规模：",e);var t=[0,1,8,9,10],i=game.curSave.myTeam.length,a=common.random(i-1,i);2==e&&(a=i),3==e&&(t=[0,1,4,6,7,8,9,10],a=common.random(i,i+1)),4==e&&(t=[0,1,2,3,4,6,7,8,9,10],a=common.random(i,i+2)),5==e&&(t=[0,1,2,3,4,5,6,7,8,9,10],a=common.random(i+2,i+4)),a=2;for(var s=0;s<a;s++){var n=t[common.random(0,t.length-1)],o=Object(x["b"])(n);game.battleTempEnemys.push(JSON.parse(JSON.stringify(o))),o.__proto__=new M,o.init("enemy",this.map,this.peos,this.elements,this.enemys),this.createEnemyEquips(o),o.updateAbility(),this.enemys.push(o),this.tempEnemys.push(o)}this.putPeos("enemys"),console.log("生成敌方：",this.enemys)},createEnemyEquips:function(e){-1!=[0,1,8,9,10].indexOf(e.type)?this.createEnemyEquip(e,0):-1!=[4,6,7].indexOf(e.type)?this.createEnemyEquip(e,1):this.createEnemyEquip(e,2)},createEnemyEquip:function(e,t){var i=[[11],[11,12],[12,13]][t],a=[[8],[8,9],[9,10]][t],s=[[17,18,19,20,21],[18,19,20,21,23],[18,19,20,21,22,23]][t],n=[[14],[14,15],[15,16]][t],o=0==t&&common.random(0,1)||t>0?Object(x["a"])(i[common.random(0,i.length-1)]):void 0,r=Object(x["a"])(a[common.random(0,a.length-1)]),c=Object(x["a"])(s[common.random(0,s.length-1)]),l=void 0;0==c.th&&(l=1==common.random(0,1)?Object(x["a"])(n[common.random(0,n.length-1)]):void 0),this.peoAddEquip(e,"head",o),this.peoAddEquip(e,"body",r),this.peoAddEquip(e,"leftHand",c),this.peoAddEquip(e,"rightHand",l)},peoAddEquip:function(e,t,i){i&&e.addEquip(t,i)},initElements:function(){var e=parseInt(((this.mapSize.xMax+1)*(this.mapSize.yMax+1)-this.peos.length-this.enemys.length)/5),t=common.random(parseInt(e/2),e);t=0;for(var i=0;i<t;i++){var a=common.creatPoint(this.mapSize.xMax,this.mapSize.yMax,this.map.banPoints),s=[10,11,20,21,22],n={id:common.createUniqueId(),type:s[common.random(0,s.length-1)],x:a[0],y:a[1],_type:"element"};this.elements.push(n),this.map.banPoints.push([n.x,n.y])}},putPeos:function(e){var t=this,i="myTeam"==e?this.mapSize.yMax:0,a="myTeam"==e?this.peos:this.enemys,s=parseInt((this.mapSize.xMax+1-a.length)/2);s=s<0?0:s,a.forEach((function(e,a){e.x=s+a,e.y=i,t.map.banPoints.push([e.x,e.y])}))},initMap:function(){var e={};e.peos=this.peos,e.elements=this.elements,e.enemys=this.enemys,e.$map=this.$map;var t=document.documentElement.clientWidth;this.unitSize=e.unitSize=parseInt(t/this.mapDiv),e.cols=Math.round(1*(this.mapSize.xMax+1)),e.rows=Math.round(1*(this.mapSize.yMax+1)),this.map.init(e)},nextRound:function(){var e=this;this.round++,console.warn("第"+this.round+"回合，"+(this.round%2==0?"敌方":"我方")+"开始"),this.round%2==0?(this.resetStatusAndCheckBuffs(this.enemys),this.AI.start(this.enemys[0],this.isGameOver,(function(){e.aiEndCallBack(0)}))):this.resetStatusAndCheckBuffs(this.peos)},aiEndCallBack:function(e){var t=this;e++,this.isRoundEnd(this.enemys)?this.nextRound():this.AI.start(this.enemys[e],this.isGameOver,(function(){t.aiEndCallBack(e)}))},isRoundEnd:function(e){var t=e.length;return e.forEach((function(e){"end"==e._state&&t--})),t<=0},resetStatusAndCheckBuffs:function(e){e.forEach((function(e){e.resetStatus(),e.checkBuffs()}))},click_cancle:function(){this.curPeo&&(this.curPeo.cancle(),this.curPeo=null),this.curSkill=null,this.skills=[]},click_end:function(){this.peos.forEach((function(e){e.action_end()})),this.click_cancle(),this.nextRound()}},beforeDestroy:function(){}},se=ae,ne=(i("ff96"),Object(f["a"])(se,N,j,!1,null,null,null)),oe=ne.exports,re=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"BattleEnd",attrs:{component:"BattleEnd"}},[i("h3",{staticClass:"title"},[e._v(e._s(1==e.winner?"胜利":"战败"))]),i("section",{directives:[{name:"show",rawName:"v-show",value:1==e.page,expression:"page==1"}],staticClass:"page pageExp"},[i("div",{staticClass:"in"},[i("ul",e._l(e.peos,(function(t){return i("li",{key:t.id,staticClass:"clearfix"},[i("div",{staticClass:"lv"},[e._v(" LV"+e._s(t.level)+" ")]),i("div",{directives:[{name:"show",rawName:"v-show",value:t.level-t._level>0,expression:"peo.level-peo._level>0"}],staticClass:"lvUp"},[i("van-icon",{attrs:{name:"upgrade"}}),i("span",{staticClass:"num"},[e._v(e._s(t.level-t._level))])],1),i("div",{staticClass:"pic"},[i("Peo",{attrs:{peo:t}})],1),i("div",{staticClass:"con"},[i("p",[e._v("击杀："),i("span",[e._v(e._s(t._kills))])]),i("p",[e._v("伤害："),i("span",[e._v(e._s(t._damages))])]),i("p",[e._v("经验："),i("span",[e._v(e._s(t._exp))])])])])})),0)]),i("div",{staticClass:"btns"},[i("van-button",{attrs:{block:"",type:"default"},nativeOn:{touchend:function(t){t.preventDefault(),t.stopPropagation(),e.page=2}}},[e._v(" 奖 励 ")])],1)]),i("section",{directives:[{name:"show",rawName:"v-show",value:2==e.page,expression:"page==2"}],staticClass:"page pageExp"},[i("div",{staticClass:"in"},[i("van-grid",{staticClass:"goodsList",attrs:{"column-num":4,gutter:10}},e._l(e.rewardGoods,(function(t){return i("van-grid-item",{key:t.id,class:[""],nativeOn:{touchend:function(i){return i.preventDefault(),i.stopPropagation(),e.clickItem(t)}}},[i("Goods",{attrs:{item:t,showBtn:!1,goodsSelects:e.goodsSelects}})],1)})),1)],1),i("div",{staticClass:"btns"},[i("div",{staticStyle:{overflow:"hidden","margin-bottom":"10px"}},[i("van-button",{directives:[{name:"show",rawName:"v-show",value:0!=e.goodsSelects.length,expression:"goodsSelects.length!=0"}],staticClass:"pull-right",attrs:{size:"small",type:"default"},nativeOn:{touchend:function(t){return t.preventDefault(),t.stopPropagation(),e.selectAll(!1)}}},[e._v(" 清除 ")]),i("van-button",{directives:[{name:"show",rawName:"v-show",value:0==e.goodsSelects.length,expression:"goodsSelects.length==0"}],staticClass:"pull-right",attrs:{size:"small",type:"default"},nativeOn:{touchend:function(t){return t.preventDefault(),t.stopPropagation(),e.selectAll(!0)}}},[e._v(" 全选 ")]),e._v(" 当前背包："+e._s(e.count)+"/"+e._s(e.game.packageMaxCount)+" ")],1),i("van-button",{attrs:{block:"",type:"default"},nativeOn:{touchend:function(t){return t.preventDefault(),t.stopPropagation(),e.click_confirm(t)}}},[e._v(" 确 定 ")])],1)])])},ce=[],le=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("section",{staticClass:"goods",attrs:{component:"Goods"}},[i("ul",{staticClass:"lines"},[i("li",{staticClass:"item"},[i("span",{staticClass:"line"},[i("i",{style:{width:Math.round(this.item.dur/this.item.durMax*100)+"%"}}),i("b",[e._v(e._s(e.item.dur+"/"+e.item.durMax))])])])]),i("i",{class:["iconfont","icon-"+e.data.goods.find((function(t){return t.id==e.item.type})).icon]}),i("span",{staticClass:"van-grid-item__text"},[e._v(e._s(e.item.name))]),i("i",{staticClass:"price"},[e._v("$"+e._s(e.item.price))]),i("van-icon",{directives:[{name:"show",rawName:"v-show",value:e.selected,expression:"selected"}],attrs:{name:"success"}}),e.showBtn?i("van-button",{attrs:{type:"primary"},nativeOn:{touchend:function(t){return t.preventDefault(),t.stopPropagation(),e.click_button(e.item)}}},[e._v(e._s(e.btnTxt))]):e._e()],1)},ue=[],pe={data:function(){return{perc:0}},props:["item","showBtn","btnTxt","goodsSelects"],computed:{selected:function(){return!!this.goodsSelects&&-1!=this.goodsSelects.indexOf(this.item.id)}},mounted:function(){},methods:{click_button:function(e){this.$emit("click_button",e)}},beforeDestroy:function(){}},de=pe,he=(i("c3d0"),Object(f["a"])(de,le,ue,!1,null,null,null)),_e=he.exports,fe={data:function(){return{page:1,peos:[],enemys:[],rewardGoods:[],goodsSelects:[]}},created:function(){this.winner=this.$route.params.winner,this.peos=this.$route.params.peos,this.enemys=this.$route.params.enemys,this.totalExp=0,this.accountReward()},computed:{count:function(){return game.curSave.myGoods.length+this.goodsSelects.length}},mounted:function(){},methods:{accountReward:function(){var e=this;if(1==this.winner){var t=Object(x["a"])(-1),i=this.$store.state.targetNode.size;t.price=(100+common.random(-20,20))*i*i,t.name="$"+t.price,this.rewardGoods.push(t)}this.enemys.forEach((function(t){if(!(t.hp>0))for(var i in e.totalExp+=t.killExp,t._equips){var a=t._equips[i];a&&e.rewardGoods.push(a)}})),this.selectAll(!0),this.peos.forEach((function(t){t._level=t.level,t._exp=Math.round(e.totalExp/e.peos.length),t.exp+=t._exp,t.level=t.getLevel();for(var i=t.level-t._level,a=1;a<=i;a++)t.addLevelPoint(t._level+a),t.addSkillPoint(t._level+a);t.battles++}))},click_confirm:function(){this.peos.forEach((function(e){Object(x["i"])(e)})),this.rewardGoods.forEach((function(e){-1==e.type?game.curSave.gold+=e.price:game.curSave.myGoods.push(e)})),this.$store.commit("updateStore"),this.$router.push({name:"Home",params:{winner:this.winner}})},selectAll:function(e){var t=this;e?(this.goodsSelects=[],this.rewardGoods.forEach((function(e){t.goodsSelects.push(e.id)}))):this.goodsSelects=[]},clickItem:function(e){var t=this.goodsSelects.indexOf(e.id);-1==t?this.goodsSelects.push(e.id):this.goodsSelects.splice(t,1)}},components:{Peo:K,Goods:_e}},me=fe,ve=(i("69fb"),Object(f["a"])(me,re,ce,!1,null,null,null)),ge=ve.exports,ye=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"team",attrs:{components:"Team"}},[e.peo?i("section",{staticClass:"info"},[i("PeoStatus",{attrs:{peo:e.peo}}),i("table",{staticClass:"attrTable"},[e._m(0),i("tr",[i("td",{staticClass:"label"},[e._v("攻击：")]),i("td",[e._v(e._s(e.peo.atk))]),i("td",{staticClass:"label"},[e._v("命中：")]),i("td",[e._v(e._s(e.peo.hit)+"%")]),i("td",{staticClass:"label"},[e._v("闪避：")]),i("td",[e._v(e._s(e.peo.dod)+"%")])]),i("tr",[i("td",{staticClass:"label"},[e._v("反击：")]),i("td",[e._v(e._s(e.peo.atkb)+"%")]),i("td",{staticClass:"label"},[e._v("先手反击：")]),i("td",[e._v(e._s(e.peo.fatkb)+"%")]),i("td",{staticClass:"label"},[e._v("暴头：")]),i("td",[e._v(e._s(e.peo.hh)+"%")])]),i("tr",[i("td",{staticClass:"label"},[e._v("被暴头：")]),i("td",[e._v(e._s(e.peo.hhb)+"%")]),i("td",{staticClass:"label"},[e._v("士气：")]),i("td",[e._v(e._s(e.peo.mor))])])]),i("table",{staticClass:"attrTable"},[i("tr",{staticClass:"title"},[i("td",{attrs:{colspan:"6"}},[e.peo.levelPoints>0?i("van-button",{staticClass:"pull-right",attrs:{size:"mini",type:"primary"},nativeOn:{touchend:function(t){return t.preventDefault(),t.stopPropagation(),e.click_attrUp(t)}}},[e._v("+ "+e._s(e.peo.levelPoints))]):e._e(),i("strong",[e._v("属性")])],1)]),i("tr",[i("td",{staticClass:"label"},[e._v("生命：")]),i("td",[e._v(e._s(e.peo.hp)+" "),i("van-rate",{attrs:{readonly:"",count:3},model:{value:e.peo.poten.hp,callback:function(t){e.$set(e.peo.poten,"hp",t)},expression:"peo.poten.hp"}})],1),i("td",{staticClass:"label"},[e._v("力量：")]),i("td",[e._v(e._s(e.peo.pow)+" "),i("van-rate",{attrs:{readonly:"",count:3},model:{value:e.peo.poten.pow,callback:function(t){e.$set(e.peo.poten,"pow",t)},expression:"peo.poten.pow"}})],1),i("td",{staticClass:"label"},[e._v("敏捷：")]),i("td",[e._v(e._s(e.peo.agi)+" "),i("van-rate",{attrs:{readonly:"",count:3},model:{value:e.peo.poten.agi,callback:function(t){e.$set(e.peo.poten,"agi",t)},expression:"peo.poten.agi"}})],1)]),i("tr",[i("td",{staticClass:"label"},[e._v("技巧：")]),i("td",[e._v(e._s(e.peo.skill)+" "),i("van-rate",{attrs:{readonly:"",count:3},model:{value:e.peo.poten.skill,callback:function(t){e.$set(e.peo.poten,"skill",t)},expression:"peo.poten.skill"}})],1),i("td",{staticClass:"label"},[e._v("幸运：")]),i("td",[e._v(e._s(e.peo.luck)+" "),i("van-rate",{attrs:{readonly:"",count:3},model:{value:e.peo.poten.luck,callback:function(t){e.$set(e.peo.poten,"luck",t)},expression:"peo.poten.luck"}})],1),i("td",{staticClass:"label"},[e._v("意志：")]),i("td",[e._v(e._s(e.peo.will)+" "),i("van-rate",{attrs:{readonly:"",count:3},model:{value:e.peo.poten.will,callback:function(t){e.$set(e.peo.poten,"will",t)},expression:"peo.poten.will"}})],1)]),i("tr",[i("td",{staticClass:"label"},[e._v("耐力：")]),i("td",[e._v(e._s(e.peo.endu)+" "),i("van-rate",{attrs:{readonly:"",count:3},model:{value:e.peo.poten.endu,callback:function(t){e.$set(e.peo.poten,"endu",t)},expression:"peo.poten.endu"}})],1),i("td",{staticClass:"label"},[e._v("移动：")]),i("td",[e._v(e._s(e.peo.move))]),i("td",{staticClass:"label"},[e._v("工资：")]),i("td",[e._v(e._s(e.peo.pay))])])]),e.peo?i("section",{staticClass:"equips"},[i("ul",e._l(e.peo._equips,(function(t,a){return i("li",{on:{touchend:function(t){return t.preventDefault(),t.stopPropagation(),e.click_equip(a)}}},[i("div",{staticClass:"in"},[t?i("i",{class:["iconfont","icon-"+e.data.goods.find((function(e){return e.id==t.type})).icon]}):"head"==a?i("span",[e._v("头")]):"other"==a?i("span",[e._v("饰")]):"body"==a?i("span",[e._v("身")]):"leftHand"==a?i("span",[e._v("左")]):"rightHand"==a?i("span",[e._v("右")]):e._e()])])})),0)]):e._e(),i("table",{staticClass:"attrTable"},[i("tr",{staticClass:"title"},[i("td",{attrs:{colspan:"6"}},[e.peo.skillPoints>0?i("van-button",{staticClass:"pull-right",attrs:{size:"mini",type:"primary"}},[e._v("+ "+e._s(e.peo.skillPoints))]):e._e(),i("strong",[e._v("技能")])],1)])]),i("table",{staticClass:"attrTable"},[e._m(1),i("tr",[i("td",{staticClass:"label"},[e._v("参战：")]),i("td",[e._v(e._s(e.peo.battles))]),i("td",{staticClass:"label"},[e._v("场均击杀：")]),i("td",[e._v(e._s(0==e.peo.battles?0:(e.peo.kills/e.peo.battles).toFixed(2)))]),i("td",{staticClass:"label"},[e._v("场均伤害：")]),i("td",[e._v(e._s(0==e.peo.battles?0:(e.peo.damages/e.peo.battles).toFixed(2)))])]),i("tr",[i("td",{staticClass:"label"},[e._v("场均命中：")]),i("td",[e._v(e._s(0==e.peo.battles?0:(e.peo.hits/e.peo.battles).toFixed(2)))]),i("td",{staticClass:"label"},[e._v("场均闪避：")]),i("td",[e._v(e._s(0==e.peo.battles?0:(e.peo.dodges/e.peo.battles).toFixed(2)))]),i("td",{staticClass:"label"},[e._v("场均暴击：")]),i("td",[e._v(e._s(0==e.peo.battles?0:(e.peo.hhs/e.peo.battles).toFixed(2)))])])])],1):e._e(),i("section",{staticClass:"peos"},[i("ul",e._l(e.peos,(function(t){return i("li",{key:t.id,class:e.peo.id==t.id?"active":"",attrs:{id:t.id},on:{touchend:function(i){return i.preventDefault(),i.stopPropagation(),e.click_peo(t)}}},[i("Peo",{attrs:{peo:t}})],1)})),0)]),i("HeaderBar"),i("FooterNav"),e.showSwitchEquip?i("SwitchEquip",{attrs:{peo:e.peo,equip:e.peo._equips[e.equipKey],equipKey:e.equipKey},on:{SwitchEquip_hide:e.SwitchEquip_hide}}):e._e(),e.peo?i("AttributeUp",{ref:"AttributeUp",attrs:{peo:e.peo}}):e._e()],1)},be=[function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("tr",{staticClass:"title"},[i("td",{attrs:{colspan:"6"}},[i("strong",[e._v("能力")])])])},function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("tr",{staticClass:"title"},[i("td",{attrs:{colspan:"6"}},[i("strong",[e._v("统计")])])])}],ke=i("ade3"),we=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"SwitchEquip",attrs:{components:"SwitchEquip"}},[i("dl",[e._m(0),i("EquipInfo",{attrs:{curItem:e.curItem,equipKey:e.equipKey}}),i("EquipInfo",{attrs:{curItem:e.targetItem,equipKey:e.equipKey}}),i("dd",[i("div",{staticClass:"icon"}),i("ul",e._l(e.compare,(function(t){return i("li",{class:e.setCompareColor(t)},[i("span",t>0?[e._v("+"+e._s(t))]:0==t?[e._v("-")]:[e._v(e._s(t))])])})),0)])],1),i("section",{staticClass:"items"},[i("van-grid",{staticClass:"goodsList",attrs:{"column-num":4,gutter:10}},e._l(e.items,(function(t){return i("van-grid-item",{key:t.id,class:[e.targetItem&&e.targetItem.id==t.id?"cur":""],nativeOn:{touchend:function(i){return i.preventDefault(),i.stopPropagation(),e.clickItem(t)}}},[i("Goods",{attrs:{item:t,showBtn:!0,btnTxt:"装备"},on:{click_button:e.confirmItem}})],1)})),1)],1),i("van-row",{staticClass:"btns"},[i("van-col",{attrs:{span:"12"}},[i("van-button",{attrs:{block:"",size:"small"},nativeOn:{touchend:function(t){return t.preventDefault(),t.stopPropagation(),e.click_remove()}}},[e._v(" 卸 载 ")])],1),i("van-col",{attrs:{span:"12"}},[i("van-button",{attrs:{block:"",size:"small"},nativeOn:{touchend:function(t){return t.preventDefault(),t.stopPropagation(),e.click_cancle()}}},[e._v(" 取 消 ")])],1)],1)],1)},Se=[function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("dd",[i("div",{staticClass:"icon"}),i("ul",[i("li",[e._v("类别：")]),i("li",[e._v("价格：")]),i("li",[e._v("品质：")]),i("li",[e._v("耐久：")]),i("li",[e._v("重量：")]),i("li",[e._v("攻击：")]),i("li",[e._v("双手：")]),i("li",[e._v("破马：")]),i("li",[e._v("破甲：")]),i("li",[e._v("穿甲：")]),i("li",[e._v("破盾：")]),i("li",[e._v("命中：")]),i("li",[e._v("爆头：")]),i("li",[e._v("范围：")]),i("li",[e._v("技能：")]),i("li",[e._v("效果：")]),i("li",[e._v("描述：")])])])}],xe=(i("4de4"),i("5319"),function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("dd",{staticClass:"EquipInfo",attrs:{components:"EquipInfo"}},[i("div",{staticClass:"icon icon1"},[e.curItem?i("i",{class:["iconfont","icon-"+e.data.goods.find((function(t){return t.id==e.curItem.type})).icon]}):"leftHand"==e.equipKey?i("span",[e._v("左")]):"rightHand"==e.equipKey?i("span",[e._v("右")]):"head"==e.equipKey?i("span",[e._v("头")]):"body"==e.equipKey?i("span",[e._v("身")]):"other"==e.equipKey?i("span",[e._v("饰")]):e._e()]),e.curItem?i("ul",[i("li",[e._v(e._s(e.data.goods.find((function(t){return t.id==e.curItem.type})).type))]),i("li",[e._v(e._s(e.curItem.price))]),i("li",[e._v(e._s(e.curItem.qua))]),i("li",[e._v(e._s(e.curItem.dur+"/"+e.curItem.durMax))]),i("li",[e._v(e._s(e.curItem.wei))]),i("li",[e._v(e._s(e.curItem.atk))]),i("li",[e._v(e._s(0==e.curItem.th?"否":"是"))]),i("li",[e._v(e._s(e.curItem.bh+"%"))]),i("li",[e._v(e._s(e.curItem.ba+"%"))]),i("li",[e._v(e._s(e.curItem.pa+"%"))]),i("li",[e._v(e._s(e.curItem.bs+"%"))]),i("li",[e._v(e._s(e.curItem.hit+"%"))]),i("li",[e._v(e._s(e.curItem.hh+"%"))]),i("li",[e._v(e._s(e.curItem.range))]),i("li",e._l(e.curItem.skill,(function(t){return i("van-tag",{key:t,attrs:{type:"0"==e.data.skills[t].class?"default":"success"}},[e._v(e._s(e.data.skills[t].type))])})),1),i("li",[e._v("待处理")]),i("li",[e._v(e._s(e.data.goods.find((function(t){return t.id==e.curItem.type})).des))])]):i("ul",e._l(e.emptyList,(function(e){return i("li")})),0)])}),Ee=[],Ce={props:["curItem","equipKey"],data:function(){return{emptyList:new Array(17)}}},Pe=Ce,Oe=Object(f["a"])(Pe,xe,Ee,!1,null,null,null),Ie=Oe.exports,qe={components:{EquipInfo:Ie,Goods:_e},props:["peo","equip","equipKey"],data:function(){return{curItem:null,targetItem:null,items:[],compare:{type:void 0,price:void 0,qua:void 0,dur:void 0,wei:void 0,atk:void 0,th:void 0,bh:void 0,ba:void 0,pa:void 0,bs:void 0,hit:void 0,hh:void 0,range:void 0,effect:void 0,skill:void 0,des:void 0}}},created:function(){this.curItem=this.equip,this.getMyGoodsMapEquipKey()},mounted:function(){},methods:{getMyGoodsMapEquipKey:function(){var e=this,t=data.equipKeyMapGoodsType[this.equipKey],i=t.replace("[","").replace("]","").split(",");this.items=game.curSave.myGoods.filter((function(t){if(-1!=i.indexOf(String(t.type))&&!e.isPeoHasEquip(t))return t})),this.items.sort((function(e,t){return t.type-e.type}))},isPeoHasEquip:function(e){for(var t=0;t<game.curSave.myTeam.length;t++){var i=game.curSave.myTeam[t];if(i.equip[this.equipKey]==e.id)return!0}return!1},clickItem:function(e){this.curItem!=e&&(this.targetItem=e,this.updateCompare())},updateCompare:function(){for(var e in this.compare)-1==["type","price","th","effect","skill","des"].indexOf(e)&&(this.compare[e]=this.targetItem[e]-(this.curItem?this.curItem[e]:0),-1!=["bh","ba","pa","bs","hit","hh"].indexOf(e)&&(this.compare[e]=this.compare[e]))},setCompareColor:function(e){if(void 0!=e)return e>0?"green":e<0?"red":void 0},confirmItem:function(e){this.peo.switchEquip(this.equipKey,this.curItem,this.targetItem),this.click_cancle()},click_remove:function(){this.peo.removeEquip(this.equipKey),this.click_cancle()},click_cancle:function(){Object(x["i"])(this.peo),this.$emit("SwitchEquip_hide")}},computed:{}},Me=qe,De=(i("3abb"),Object(f["a"])(Me,we,Se,!1,null,null,null)),Te=De.exports,Ae=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"AttributeUp"},[i("van-dialog",{ref:"dialog",attrs:{title:"请选择3个属性","show-cancel-button":"","confirm-button-color":e.confirmButtonColor,"before-close":e.beforeClose,"message-align":"left"},model:{value:e.show,callback:function(t){e.show=t},expression:"show"}},[i("van-checkbox-group",{attrs:{max:3},model:{value:e.selecedValue,callback:function(t){e.selecedValue=t},expression:"selecedValue"}},[i("van-cell-group",e._l(e.list,(function(t,a){return i("van-cell",{key:t.key,attrs:{clickable:"",title:""+t.label},nativeOn:{touchend:function(t){return t.preventDefault(),t.stopPropagation(),e.toggle(a)}},scopedSlots:e._u([{key:"right-icon",fn:function(){return[i("van-checkbox",{ref:"checkboxes",refInFor:!0,attrs:{name:t}})]},proxy:!0}],null,!0)})})),1)],1)],1)],1)},Be=[],Ne={components:{},props:["peo"],data:function(){return{list:[],selecedValue:[],show:!1,confirmButtonColor:"#666"}},created:function(){var e={hp:"生命",pow:"力量",agi:"敏捷",skill:"技巧",luck:"幸运",will:"意志",endu:"耐力"},t=this.peo.potenUp[0];for(var i in t)this.list.push({key:i,val:t[i],label:"".concat(e[i]," + ").concat(t[i])})},mounted:function(){},watch:{selecedValue:function(e,t){e.length>=3?this.confirmButtonColor="#fff":this.confirmButtonColor="#666"}},methods:{showDialog:function(){this.show=!0},toggle:function(e){this.$refs.checkboxes[e].toggle()},beforeClose:function(e,t){var i=this;if("cancel"!=e)if(this.selecedValue.length<3)t(!1);else{var a=game.curSave.myTeam.find((function(e){return e.id==i.peo.id}));this.selecedValue.forEach((function(e){a[e.key]+=e.val,"hp"==e.key&&(a.hpMax+=e.val,i.peo.hp+=e.val,i.peo.hpMax+=e.val)})),this.peo.levelPoints--,this.peo.potenUp.shift(),a.levelPoints=this.peo.levelPoints,a.potenUp=JSON.parse(JSON.stringify(this.peo.potenUp)),this.peo.updateAbility(),this.selecedValue=[],console.log(this.peo.potenUp,a.potenUp),t()}else t()}}},je=Ne,$e=Object(f["a"])(je,Ae,Be,!1,null,null,null),Re=$e.exports,Le={components:{Peo:K,SwitchEquip:Te,PeoStatus:te,AttributeUp:Re},data:function(){return Object(ke["a"])({divs:13,citys:[],peos:[],peo:null,equipKey:"",showSwitchEquip:!1},"showSwitchEquip",!1)},created:function(){var e=this;0!=game.curSave.myTeam.length?(game.curSave.myTeam.forEach((function(t){var i=JSON.parse(JSON.stringify(t));i.__proto__=new M,i.init("our"),e.peos.push(i)})),this.peo=this.peos[0],this.click_peo(this.peo)):this.$toast.fail("请先招募队员")},mounted:function(){},methods:{click_attrUp:function(){this.peo.levelPoints<=0||this.$refs.AttributeUp.showDialog()},click_peo:function(e){this.peo=e,console.log("当前人物：",this.peo)},click_equip:function(e){this.equipKey=e,this.showSwitchEquip=!0},SwitchEquip_hide:function(){this.showSwitchEquip=!1,this.peo.updateAbility()}}},Ue=Le,ze=(i("bf68"),Object(f["a"])(Ue,ye,be,!1,null,null,null)),Ke=ze.exports,Fe=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"scrollWrap",attrs:{component:"Save"}},[i("div",{staticClass:"disTable"},[i("div",{staticClass:"disTableCell"},[i("div",{staticClass:"disInblock files"},[i("van-button",{staticStyle:{height:"60px"},attrs:{icon:"plus",block:!0,type:"primary"},on:{click:e.showForm}},[e._v("新建")]),e._l(e.saveFiles,(function(t){return i("van-panel",{key:t.id,attrs:{title:t.id+":"+t.name,desc:"存档时间:"+t.saveTime},on:{click:function(i){return e.update(t)}}},[i("van-button",{attrs:{type:"default"},on:{click:function(i){return i.stopPropagation(),e.del(t)}}},[e._v("删除")])],1)}))],2)])]),i("van-dialog",{attrs:{title:"新建存档","show-cancel-button":""},on:{confirm:e.add},model:{value:e.isShowForm,callback:function(t){e.isShowForm=t},expression:"isShowForm"}},[i("van-field",{attrs:{label:"名称"},model:{value:e.newName,callback:function(t){e.newName=t},expression:"newName"}})],1),i("FooterNav")],1)},We=[],He=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{attrs:{component:"footerNav"}},[i("van-tabbar",{model:{value:e.active,callback:function(t){e.active=t},expression:"active"}},[i("van-tabbar-item",{attrs:{id:"f_home",to:"/home",icon:"location-o"}},[e._v("地图")]),i("van-tabbar-item",{attrs:{id:"f_team",to:"/team",icon:"friends-o"}},[e._v("队伍")]),i("van-tabbar-item",{attrs:{id:"f_market",to:"/city/market",icon:"shop-o"}},[e._v("商店")]),i("van-tabbar-item",{attrs:{id:"f_tavern",to:"/city/tavern",icon:"flag-o"}},[e._v("招募")]),i("van-tabbar-item",{attrs:{id:"f_option",icon:"setting-o"}},[e._v("功能")])],1),i("van-action-sheet",{attrs:{actions:e.actions,"cancel-text":"取消"},on:{select:e.onSelect},model:{value:e.showOption,callback:function(t){e.showOption=t},expression:"showOption"}})],1)},Ge=[],Ze={data:function(){return{active:0,showOption:!1,actions:[{name:"存档"},{name:"读档"},{name:"设置"},{name:"开始菜单"}]}},mounted:function(){var e=this;-1!=this.$route.path.indexOf("/option")?this.active=4:-1!=this.$route.path.indexOf("/tavern")?this.active=3:-1!=this.$route.path.indexOf("/market")?this.active=2:-1!=this.$route.path.indexOf("/team")&&(this.active=1),document.getElementById("f_option").onclick=function(){e.showOption=!0}},methods:{onSelect:function(e){switch(this.showOption=!1,console.log(e),e.name){case"存档":this.$router.push("/option/save");break;case"读档":this.$router.push("/option/load");break;case"设置":this.$router.push("/option/setting");break;case"开始菜单":this.$router.push("/");break}}}},Je=Ze,Ve=(i("8e73"),Object(f["a"])(Je,He,Ge,!1,null,null,null)),Ye=Ve.exports,Xe={data:function(){return{isShowForm:!1,saveFiles:game.saveFiles,newName:"新建0"}},mounted:function(){},methods:{showForm:function(){this.newName="新建"+(game.getMaxSaveId()+1),this.isShowForm=!0},add:function(){var e={id:game.getMaxSaveId()+1,name:this.newName,saveTime:(new Date).toLocaleString()};game.saveFiles.push(e),game.curSave.id=e.id,game.curSave.name=e.name,game.curSave.saveTime=e.saveTime,game.save(e.id,game.curSave)},update:function(e){this.$dialog.alert({message:"确定覆盖"+e.name+"?",showCancelButton:!0}).then((function(){e.saveTime=(new Date).toLocaleString(),game.save(e.id,game.curSave)})).catch((function(){}))},del:function(e){this.$dialog.alert({message:"确定删除"+e.name+"?",showCancelButton:!0}).then((function(){var t=game.saveFiles.findIndex((function(t){return t.id==e.id}));game.saveFiles.splice(t,1),game.removeSave(e.id)})).catch((function(){}))}},components:{FooterNav:Ye}},Qe=Xe,et=Object(f["a"])(Qe,Fe,We,!1,null,null,null),tt=et.exports,it=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"scrollWrap",attrs:{component:"Load"}},[i("div",{staticClass:"disTable"},[i("div",{staticClass:"disTableCell"},[i("div",{staticClass:"disInblock files"},e._l(e.saveFiles,(function(t){return i("van-panel",{key:t.id,attrs:{title:t.id+":"+t.name,desc:"存档时间:"+t.saveTime},on:{click:function(i){return e.clickItem(t)}}})})),1)])]),"true"==e.showBack?i("div",[i("FooterBack")],1):i("div",[i("FooterNav")],1)])},at=[],st=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{attrs:{component:"FooterBack"}},[i("van-tabbar",[i("van-tabbar-item",{attrs:{id:"f_home",icon:"arrow-left"},on:{click:function(t){return e.$router.back(-1)}}},[e._v("返回")])],1)],1)},nt=[],ot={},rt=Object(f["a"])(ot,st,nt,!1,null,null,null),ct=rt.exports,lt={data:function(){return{isShowForm:!1,saveFiles:game.saveFiles,showBack:"false"}},mounted:function(){this.showBack=this.$route.query.showBack},methods:{clickItem:function(e){game.curSave=game.load(e.id),this.$router.push("/home")}},components:{FooterNav:Ye,FooterBack:ct}},ut=lt,pt=Object(f["a"])(ut,it,at,!1,null,null,null),dt=pt.exports,ht=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"scrollWrap",attrs:{component:"Setting"}},[e._m(0),"true"==e.showBack?i("div",[i("FooterBack")],1):i("div",[i("FooterNav")],1)])},_t=[function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"disTable"},[i("div",{staticClass:"disTableCell"},[i("div",{staticClass:"disInblock"},[e._v(" 设置 ")])])])}],ft={data:function(){return{showBack:"false"}},mounted:function(){this.showBack=this.$route.query.showBack},methods:{},components:{FooterNav:Ye,FooterBack:ct}},mt=ft,vt=Object(f["a"])(mt,ht,_t,!1,null,null,null),gt=vt.exports,yt=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"scrollWrap",staticStyle:{"overflow-y":"hidden"},attrs:{component:"Market"}},[i("section",{staticClass:"disTable"},[i("div",{staticClass:"disTableCell"},[i("div",{staticClass:"disInblock market"},[i("section",{staticClass:"intro"},[i("div",{staticClass:"in"},[null==e.curItem?i("div",[i("p",[e._v("店主：")]),i("p",[e._v("欢迎来到我们的商店，请选择你的商品，良心作生意，童叟无欺。")])]):i("div",[i("p",[e.curItem.price>e.$store.state.gold?i("span",{staticClass:"pull-right",staticStyle:{color:"#f00"}},[e._v(" $"+e._s(e.curItem.price)+"（买不起） ")]):i("span",{staticClass:"pull-right",staticStyle:{color:"#d9cc38"}},[e._v(" $"+e._s(e.curItem.price)+" ")]),e._v(" 物品："),i("strong",[e._v(e._s(e.curItem.name))])]),i("p",{staticClass:"des"},[e._v("描述："+e._s(e.data.goods.find((function(t){return t.id==e.curItem.type})).des))]),"{}"!=JSON.stringify(e.curItem.effect)?i("p",[e._v(" 效果：待处理 ")]):e._e(),e.itemSkills.length>0?i("p",[e._v(" 技能： "),e._l(e.itemSkills,(function(t){return i("van-tag",{key:t.id,attrs:{type:"0"==t.class?"default":"success"}},[e._v(e._s(t.type))])}))],2):e._e(),i("ul",{staticClass:"attr"},[i("li",[e._v("品质："+e._s(e.curItem.qua))]),i("li",[e._v("耐久度："+e._s(e.curItem.dur))]),i("li",[e._v("重量："+e._s(e.curItem.wei))])]),i("ul",{staticClass:"attr"},[i("li",[e._v("攻击力："+e._s(e.curItem.atk))]),i("li",[e._v("双手："+e._s(0==e.curItem.th?"否":"是"))]),i("li",[e._v("破马率："+e._s(e.curItem.bh+"%"))]),i("li",[e._v("破甲率："+e._s(e.curItem.ba+"%"))]),i("li",[e._v("穿甲率："+e._s(e.curItem.pa+"%"))]),i("li",[e._v("破盾率："+e._s(e.curItem.bs+"%"))]),i("li",[e._v("命中率："+e._s(e.curItem.hit+"%"))]),i("li",[e._v("爆头率："+e._s(e.curItem.hh+"%"))]),i("li",[e._v("攻击范围："+e._s(e.curItem.range))])])])]),i("van-button",{staticStyle:{position:"absolute",right:"10px",bottom:"10px"},attrs:{size:"small",type:"primary"},nativeOn:{touchend:function(t){return t.preventDefault(),t.stopPropagation(),e.buyAll()}}},[e._v("全部购买")])],1),i("section",{staticClass:"items"},[i("van-grid",{staticClass:"goodsList",attrs:{"column-num":4,gutter:10}},e._l(e.items,(function(t){return i("van-grid-item",{key:t.id,class:[e.curItem==t?"cur":"",t.price>e.$store.state.gold?"disabled":""],on:{click:function(i){return e.clickItem(t)}}},[i("Goods",{attrs:{item:t,showBtn:!0,btnTxt:"购买"},on:{click_button:e.buy}})],1)})),1)],1),i("van-row",{staticClass:"btns"},[i("van-col",{attrs:{span:"12"}},[i("van-button",{attrs:{block:"",size:"small",type:"buy"==e.curType?"primary":"default"},nativeOn:{touchend:function(t){return t.preventDefault(),t.stopPropagation(),e.setGoods("buy")}}},[e._v(" 买 入 ")])],1),i("van-col",{attrs:{span:"12"}},[i("van-button",{attrs:{block:"",size:"small",type:"sell"==e.curType?"primary":"default"},nativeOn:{touchend:function(t){return t.preventDefault(),t.stopPropagation(),e.setGoods("sell")}}},[e._v(" 卖 出 ")])],1)],1)],1)])]),i("HeaderBar"),i("FooterNav")],1)},bt=[],kt={components:{Goods:_e},data:function(){return{items:[],curItem:null,curType:"buy"}},created:function(){this.setGoods("buy")},computed:{itemSkills:function(){var e=[];return this.curItem.skills.forEach((function(t){var i=data.skills.find((function(e){return e.id==t}));i&&e.push(i)})),e}},mounted:function(){},methods:{setGoods:function(e){this.curItem=null,this.curType=e,this.items="sell"==e?game.curSave.myGoods:game.curSave.goods,this.items.sort((function(e,t){return e.price-t.price}))},clickItem:function(e){this.curItem=e,e.price,game.curSave.gold},buy:function(e){if(!(e.price>this.$store.state.gold)){switch(game.curSave.gold-=e.price,e.type){case 0:game.curSave.food+=100;break;case 1:game.curSave.tool+=100;break;case 2:game.curSave.medication+=100;break;case 3:game.curSave.arrow+=100;break;default:var t=game.curSave.goods.findIndex((function(t){return t.id==e.id}));game.curSave.goods.splice(t,1),game.curSave.myGoods.push(e);break}this.$store.commit("updateStore")}},buyAll:function(){for(var e=this.items.length-1;e>=0;e--)this.buy(this.items[e])}}},wt=kt,St=(i("928d"),Object(f["a"])(wt,yt,bt,!1,null,null,null)),xt=St.exports,Et=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"scrollWrap",attrs:{component:"Tavern"}},[i("section",{staticClass:"disTable"},[i("div",{staticClass:"disTableCell"},[i("div",{staticClass:"disInblock files"},e._l(e.peos,(function(t){return i("van-panel",{key:t.id,attrs:{title:"["+e.common.getTypeName("peos",t.type)+"]"+t.name,desc:"招募费用："+t.price+" | 工资："+t.pay}},[i("van-button",{attrs:{disabled:t.price>e.$store.state.gold,type:"primary"},on:{click:function(i){return e.clickItem(t)}}},[e._v("招募")])],1)})),1)])]),i("HeaderBar"),i("FooterNav")],1)},Ct=[],Pt={data:function(){return{peos:[],total:0}},created:function(){this.$route.query.id;this.peos=game.curSave.peos},mounted:function(){},methods:{clickItem:function(e){var t=this;this.$dialog.confirm({title:"招募",message:"["+common.getTypeName("peos",e.type)+"]"+e.name+"，费用："+e.price}).then((function(){game.curSave.gold-=e.price,t.$store.commit("updateStore"),game.curSave.myTeam.push(e);var i=game.curSave.peos.findIndex((function(t){return t.id==e.id}));game.curSave.peos.splice(i,1)})).catch((function(){}))},onSubmit:function(){console.log(this.total)}}},Ot=Pt,It=Object(f["a"])(Ot,Et,Ct,!1,null,null,null),qt=It.exports,Mt=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"disTable",attrs:{component:"Start"}},[i("div",{staticClass:"disTableCell"},[i("div",{staticClass:"disInblock menuBtns"},[i("van-button",{attrs:{icon:"smile-o",block:!0,type:"default"},on:{click:e.newGame}},[e._v("新游戏")]),i("van-button",{attrs:{icon:"peer-pay",block:!0,type:"default"},on:{click:e.fastLoad}},[e._v("快速读档")]),i("van-button",{attrs:{icon:"peer-pay",block:!0,type:"default",to:"/option/load?showBack=true"}},[e._v("读档")]),i("van-button",{attrs:{icon:"setting-o",block:!0,type:"default",to:"/option/setting?showBack=true"}},[e._v("设置")])],1)])])},Dt=[],Tt={data:function(){return{}},mounted:function(){},methods:{newGame:function(){game.curSave={gold:999990,date:0,food:30,tool:100,medication:100,arrow:30,myTeam:[],myGoods:[],peos:[],goods:[],curNode:null},this.createNodes(),this.createPeos(),this.createGoods(),this.$store.commit("updateStore"),this.$router.push("/home")},fastLoad:function(e){this.curSave=game.load(1),this.$router.push("/home")},createNodes:function(){var e=[];e.push(O.methods.createNode(0,2,0,0,0)),O.methods.createNodes(e[0]),game.curSave.nodes=e,game.curSave.curNodeId=e[0].id,this.$store.commit("updateStore"),console.log("创建地图节点",game.curSave.nodes)},createGoods:function(){for(var e=0;e<game.goodsUpdateCount;e++){var t=common.random(0,data.goods.length-2),i=Object(x["a"])(t);game.curSave.goods.push(i)}console.log("创建物品："),console.log(game.curSave.goods)},createPeos:function(){for(var e=0;e<game.peosUpdateCount;e++){var t=common.random(0,data.peos.length-1),i=Object(x["b"])(t);game.curSave.peos.push(i)}console.log("创建人物："),console.log(game.curSave.peos)}},components:{}},At=Tt,Bt=Object(f["a"])(At,Mt,Dt,!1,null,null,null),Nt=Bt.exports;l["a"].use(y["a"]);var jt=[{path:"/",meta:{title:"开始"},component:Nt},{path:"/Home",meta:{title:"世界地图"},component:B,name:"Home"},{path:"/Team",meta:{title:"队伍"},component:Ke,name:"Team"},{path:"/Battle",meta:{title:"Battle"},component:oe,name:"Battle"},{path:"/BattleEnd",meta:{title:"BattleEnd"},component:ge,name:"BattleEnd"},{path:"/Option/Save",meta:{title:"存档"},component:tt},{path:"/Option/Load",meta:{title:"读档"},component:dt},{path:"/Option/Setting",meta:{title:"设置"},component:gt},{path:"/City/market",meta:{title:"市集"},component:xt},{path:"/City/tavern",meta:{title:"酒馆"},component:qt}],$t=new y["a"]({routes:jt}),Rt=$t,Lt=i("2f62");l["a"].use(Lt["a"]);var Ut=new Lt["a"].Store({state:{gold:0,date:0,food:0,tool:0,medication:0,arrow:0,curNodeId:"",targetNode:null},mutations:{updateStore:function(e,t){game.curSave&&(e.date=game.curSave.date,e.gold=game.curSave.gold,e.food=game.curSave.food,e.tool=game.curSave.tool,e.medication=game.curSave.medication,e.arrow=game.curSave.arrow,e.curNodeId=game.curSave.curNodeId)},change_targetNode:function(e,t){e.targetNode=t}},actions:{},modules:{}}),zt=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("Header",{staticClass:"headerBar",attrs:{component:"HeaderBar"}},[i("div",{staticStyle:{padding:"0 10px"}},[i("span",{staticClass:"pull-right"},[i("label",[i("i",{staticClass:"iconfont icon-gold"}),e._v(e._s(e.$store.state.gold))]),i("label",[i("i",{staticClass:"iconfont icon-food"}),e._v(e._s(e.$store.state.food))]),i("label",[i("i",{staticClass:"iconfont icon-tool"}),e._v(e._s(e.$store.state.tool))]),i("label",[i("i",{staticClass:"iconfont icon-medicinal"}),e._v(e._s(e.$store.state.medication))]),i("label",[i("i",{staticClass:"iconfont icon-arrow"}),e._v(e._s(e.$store.state.arrow))])]),i("label",[e._v("第"+e._s(e.$store.state.date)+"天")])])])},Kt=[],Ft={data:function(){return{}},mounted:function(){},methods:{}},Wt=Ft,Ht=Object(f["a"])(Wt,zt,Kt,!1,null,null,null),Gt=Ht.exports;window.data=a,window.game=new r,game.init(),l["a"].use(u["a"]),l["a"].config.productionTip=!1,l["a"].prototype.data=window.data,l["a"].prototype.game=window.game,l["a"].prototype.common=window.common,Rt.beforeEach((function(e,t,i){e.meta.title&&(document.title=e.meta.title),i()})),l["a"].component("HeaderBar",Gt),l["a"].component("FooterBack",ct),l["a"].component("FooterNav",Ye),new l["a"]({router:Rt,store:Ut,render:function(e){return e(v)}}).$mount("#app")},5874:function(e,t,i){},5924:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"c",(function(){return getCurNodeById})),__webpack_require__.d(__webpack_exports__,"d",(function(){return getDataItem})),__webpack_require__.d(__webpack_exports__,"b",(function(){return createPeo})),__webpack_require__.d(__webpack_exports__,"a",(function(){return createGood})),__webpack_require__.d(__webpack_exports__,"f",(function(){return getPointUnit})),__webpack_require__.d(__webpack_exports__,"h",(function(){return getTriggerRangeUnits})),__webpack_require__.d(__webpack_exports__,"g",(function(){return getTriggerRange})),__webpack_require__.d(__webpack_exports__,"e",(function(){return getPointRange})),__webpack_require__.d(__webpack_exports__,"i",(function(){return peoSave}));var core_js_modules_es_symbol__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("a4d3"),core_js_modules_es_symbol__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(core_js_modules_es_symbol__WEBPACK_IMPORTED_MODULE_0__),core_js_modules_es_symbol_description__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("e01a"),core_js_modules_es_symbol_description__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(core_js_modules_es_symbol_description__WEBPACK_IMPORTED_MODULE_1__),core_js_modules_es_symbol_iterator__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("d28b"),core_js_modules_es_symbol_iterator__WEBPACK_IMPORTED_MODULE_2___default=__webpack_require__.n(core_js_modules_es_symbol_iterator__WEBPACK_IMPORTED_MODULE_2__),core_js_modules_es_array_find__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("7db0"),core_js_modules_es_array_find__WEBPACK_IMPORTED_MODULE_3___default=__webpack_require__.n(core_js_modules_es_array_find__WEBPACK_IMPORTED_MODULE_3__),core_js_modules_es_array_for_each__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("4160"),core_js_modules_es_array_for_each__WEBPACK_IMPORTED_MODULE_4___default=__webpack_require__.n(core_js_modules_es_array_for_each__WEBPACK_IMPORTED_MODULE_4__),core_js_modules_es_array_index_of__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("c975"),core_js_modules_es_array_index_of__WEBPACK_IMPORTED_MODULE_5___default=__webpack_require__.n(core_js_modules_es_array_index_of__WEBPACK_IMPORTED_MODULE_5__),core_js_modules_es_number_constructor__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("a9e3"),core_js_modules_es_number_constructor__WEBPACK_IMPORTED_MODULE_6___default=__webpack_require__.n(core_js_modules_es_number_constructor__WEBPACK_IMPORTED_MODULE_6__),core_js_modules_es_object_to_string__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__("d3b7"),core_js_modules_es_object_to_string__WEBPACK_IMPORTED_MODULE_7___default=__webpack_require__.n(core_js_modules_es_object_to_string__WEBPACK_IMPORTED_MODULE_7__),core_js_modules_es_regexp_exec__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__("ac1f"),core_js_modules_es_regexp_exec__WEBPACK_IMPORTED_MODULE_8___default=__webpack_require__.n(core_js_modules_es_regexp_exec__WEBPACK_IMPORTED_MODULE_8__),core_js_modules_es_regexp_to_string__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__("25f0"),core_js_modules_es_regexp_to_string__WEBPACK_IMPORTED_MODULE_9___default=__webpack_require__.n(core_js_modules_es_regexp_to_string__WEBPACK_IMPORTED_MODULE_9__),core_js_modules_es_string_iterator__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__("3ca3"),core_js_modules_es_string_iterator__WEBPACK_IMPORTED_MODULE_10___default=__webpack_require__.n(core_js_modules_es_string_iterator__WEBPACK_IMPORTED_MODULE_10__),core_js_modules_es_string_replace__WEBPACK_IMPORTED_MODULE_11__=__webpack_require__("5319"),core_js_modules_es_string_replace__WEBPACK_IMPORTED_MODULE_11___default=__webpack_require__.n(core_js_modules_es_string_replace__WEBPACK_IMPORTED_MODULE_11__),core_js_modules_es_string_split__WEBPACK_IMPORTED_MODULE_12__=__webpack_require__("1276"),core_js_modules_es_string_split__WEBPACK_IMPORTED_MODULE_12___default=__webpack_require__.n(core_js_modules_es_string_split__WEBPACK_IMPORTED_MODULE_12__),core_js_modules_web_dom_collections_for_each__WEBPACK_IMPORTED_MODULE_13__=__webpack_require__("159b"),core_js_modules_web_dom_collections_for_each__WEBPACK_IMPORTED_MODULE_13___default=__webpack_require__.n(core_js_modules_web_dom_collections_for_each__WEBPACK_IMPORTED_MODULE_13__),core_js_modules_web_dom_collections_iterator__WEBPACK_IMPORTED_MODULE_14__=__webpack_require__("ddb0"),core_js_modules_web_dom_collections_iterator__WEBPACK_IMPORTED_MODULE_14___default=__webpack_require__.n(core_js_modules_web_dom_collections_iterator__WEBPACK_IMPORTED_MODULE_14__);function getCurNodeById(e,t){for(var i=0;i<t.length;i++){var a=t[i];if(a.id==e)return a;if(a.children){var s=getCurNodeById(e,a.children);if(s)return s}}}function getDataItem(e,t){var i={},a=data[e].find((function(e){return e.id==t}));return o2o(a,i),i}function createPeo(e){var t={};t.type=e;var i=data.peos.find((function(e){return e.id==t.type}));for(var a in o2o(i,t),t.poten={hp:0,pow:0,agi:0,skill:0,luck:0,will:0,endu:0},t.potenUp=[],t.poten)t.poten[a]=common.getNumberInAppoint([[0,.3],[1,.4],[2,.2],[3,.1]]);return t.type=t.id,t.id=common.createUniqueId(),t.name=common.createRandomName(),t.level=0,t.levelPoints=0,t.skillPoints=0,t.exp=0,t.hpMax=t.hp,t.equip={head:"",other:"",body:"",leftHand:"",rightHand:""},t.x=0,t.y=0,t.buffs=[],t.skills=[-1,99],t.dates=0,t.battles=0,t.kills=0,t.damages=0,t.hits=0,t.dodges=0,t.hhs=0,t}function createGood(e){var t={};t.type=e;var i=data.goods.find((function(e){return e.id==t.type}));return o2o(i,t),t.type=t.id,t.id=common.createUniqueId(),t.name=common.getTypeName("goods",t.type)+t.qua.toString(),t.durMax=t.dur,t}function o2o(source,target){for(var k in source){var val=source[k];if(isNaN(val))if(-1!=val.indexOf("~")&&"range"!=k){var ary=val.split("~");target[k]=common.random(Number(ary[0]),Number(ary[1]))}else-1!=val.indexOf("[")?target[k]=eval(val):-1!=val.indexOf("{")?(val=val.replace(/'/g,'"'),target[k]=JSON.parse(val)):"des"!=k&&"icon"!=k&&(target[k]=val);else target[k]=Number(val)}}function getPointUnit(e,t,i,a){var s=!0,n=!1,o=void 0;try{for(var r,c=t[Symbol.iterator]();!(s=(r=c.next()).done);s=!0){var l=r.value;if(l.x==e[0]&&l.y==e[1])return l}}catch(w){n=!0,o=w}finally{try{s||null==c.return||c.return()}finally{if(n)throw o}}var u=!0,p=!1,d=void 0;try{for(var h,_=i[Symbol.iterator]();!(u=(h=_.next()).done);u=!0){var f=h.value;if(f.x==e[0]&&f.y==e[1])return f}}catch(w){p=!0,d=w}finally{try{u||null==_.return||_.return()}finally{if(p)throw d}}var m=!0,v=!1,g=void 0;try{for(var y,b=a[Symbol.iterator]();!(m=(y=b.next()).done);m=!0){var k=y.value;if(k.x==e[0]&&k.y==e[1])return k}}catch(w){v=!0,g=w}finally{try{m||null==b.return||b.return()}finally{if(v)throw g}}}function getTriggerRangeUnits(e,t,i,a,s,n){var o=[];return t.forEach((function(t){var r=getPointUnit(t,a,s,n);r&&("our"==e._type&&"enemy"==r._type&&1==i.class||"our"==e._type&&"our"==r._type&&0==i.class||"enemy"==e._type&&"our"==r._type&&1==i.class||"enemy"==e._type&&"enemy"==r._type&&0==i.class)&&o.push(r)})),o}function getTriggerRange(e,t,i,a){if(1==t.type)return getPointRange(e,t.trigger,i);if(2==t.type){var s=!0,n=!1,o=void 0;try{for(var r,c=t.trigger[Symbol.iterator]();!(s=(r=c.next()).done);s=!0){var l=r.value,u=getPointRange([a.x,a.y],l,i);if(-1!=common.indexOf2Array(e,u))return u}}catch(p){n=!0,o=p}finally{try{s||null==c.return||c.return()}finally{if(n)throw o}}}}function getPointRange(e,t,i){var a=[];return t.forEach((function(t){var s=[t[0]+e[0],t[1]+e[1]];0<=s[0]&&s[0]<i.cols&&0<=s[1]&&s[1]<i.rows&&a.push(s)})),a}function peoSave(e){var t=game.curSave.myTeam.find((function(t){return t.id==e.id}));t.hp=e.hp,t.battles=e.battles,t.level=e.level,t.exp=e.exp,t.levelPoints=e.levelPoints,t.skillPoints=e.skillPoints,t.damages+=e._damages,t.dodges+=e._dodges,t.hits+=e._hits,t.hhs+=e._hhs,t.kills+=e._kills,t.potenUp=JSON.parse(JSON.stringify(e.potenUp)),t.buffs=JSON.parse(JSON.stringify(e.buffs)),t.equip=JSON.parse(JSON.stringify(e.equip)),t.skills=JSON.parse(JSON.stringify(e.skills))}},"5c0b":function(e,t,i){"use strict";var a=i("9c0c"),s=i.n(a);s.a},"5c67":function(e,t,i){},"69fb":function(e,t,i){"use strict";var a=i("5874"),s=i.n(a);s.a},"839c":function(e,t,i){},"8e73":function(e,t,i){"use strict";var a=i("add7"),s=i.n(a);s.a},"928d":function(e,t,i){"use strict";var a=i("265f"),s=i.n(a);s.a},"9c0c":function(e,t,i){},add7:function(e,t,i){},bf68:function(e,t,i){"use strict";var a=i("df89"),s=i.n(a);s.a},c3d0:function(e,t,i){"use strict";var a=i("0c52"),s=i.n(a);s.a},d30f:function(e){e.exports=JSON.parse('{"exp":[0,100,300,800,1200,1800,2200,2600,3000,3500,4000,4000,4000,4000,4000,4000,4000,4000,4000,4000,4000],"equipKeyMapGoodsType":{"head":"[11,12,13]","other":"[4]","body":"[8,9,10]","leftHand":"[17,18,19,20,21,22,23,24]","rightHand":"[14,15,16,17,18,20,21]"},"peos":[{"id":"0","type":"民兵","hp":"50~60","pow":"2~7","agi":"2~7","skill":"0~5","luck":"0~5","will":"0~5","endu":"3~5","move":"3","price":"150","pay":"2","killExp":"100"},{"id":"1","type":"农民","hp":"40~50","pow":"1~5","agi":"0~5","skill":"0~5","luck":"2~7","will":"0~5","endu":"4~6","move":"3","price":"75","pay":"1","killExp":"75"},{"id":"2","type":"雇佣兵","hp":"55~65","pow":"4~8","agi":"5~9","skill":"2~6","luck":"0~0","will":"2~5","endu":"4~7","move":"3","price":"300","pay":"5","killExp":"175"},{"id":"3","type":"士兵","hp":"60~68","pow":"5~9","agi":"4~8","skill":"3~6","luck":"0~0","will":"3~6","endu":"4~8","move":"3","price":"475","pay":"6","killExp":"200"},{"id":"4","type":"退伍士兵","hp":"50~60","pow":"4~8","agi":"0~4","skill":"0~3","luck":"2~7","will":"5~8","endu":"2~5","move":"3","price":"225","pay":"3","killExp":"150"},{"id":"5","type":"将军","hp":"68~78","pow":"8~12","agi":"6~9","skill":"6~9","luck":"2~5","will":"5~8","endu":"5~9","move":"3","price":"1500","pay":"12","killExp":"250"},{"id":"6","type":"盗贼","hp":"45~55","pow":"2~5","agi":"7~10","skill":"7~10","luck":"3~8","will":"0~0","endu":"2~4","move":"3","price":"150","pay":"3","killExp":"125"},{"id":"7","type":"强盗","hp":"50~60","pow":"2~7","agi":"5~9","skill":"6~9","luck":"0~0","will":"0~3","endu":"2~5","move":"3","price":"150","pay":"3","killExp":"125"},{"id":"8","type":"小贩","hp":"45~55","pow":"0~5","agi":"0~3","skill":"0~3","luck":"3~8","will":"0~2","endu":"4~7","move":"3","price":"75","pay":"1","killExp":"75"},{"id":"9","type":"流氓","hp":"40~50","pow":"2~5","agi":"1~5","skill":"1~5","luck":"0~0","will":"0~0","endu":"2~4","move":"3","price":"55","pay":"1","killExp":"55"},{"id":"10","type":"乞丐","hp":"30~40","pow":"0~3","agi":"0~3","skill":"0~3","luck":"0~0","will":"0~0","endu":"2~4","move":"3","price":"20","pay":"1","killExp":"40"}],"goods":[{"id":"-1","type":"金币","icon":"gold","des":"交易货币","price":"0","qua":"0","atk":"0","dur":"0","wei":"0","th":"0","bh":"0","ba":"0","pa":"0","bs":"0","hit":"0","hh":"0","range":"0","effect":"{}","skills":"[]"},{"id":"0","type":"食物","icon":"food","des":"100金=100食物。民以食为天，每个人每天消耗1粮食，粮食消耗完后会士气低落，甚至有人离开。","price":"100","qua":"0","atk":"0","dur":"0","wei":"0","th":"0","bh":"0","ba":"0","pa":"0","bs":"0","hit":"0","hh":"0","range":"0","effect":"{}","skills":"[]"},{"id":"1","type":"工具","icon":"tool","des":"100金=100工具。修理工具会自动修理物品，每1个工具修理1耐久度，记得补充哦。","price":"100","qua":"0","atk":"0","dur":"0","wei":"0","th":"0","bh":"0","ba":"0","pa":"0","bs":"0","hit":"0","hh":"0","range":"0","effect":"{}","skills":"[]"},{"id":"2","type":"药物","icon":"medicinal","des":"100金=100药物。药物会自动治疗伤病，1药物治疗10点hp，没有药物后，伤病可能加剧，记得补充哦。","price":"100","qua":"0","atk":"0","dur":"0","wei":"0","th":"0","bh":"0","ba":"0","pa":"0","bs":"0","hit":"0","hh":"0","range":"0","effect":"{}","skills":"[]"},{"id":"3","type":"弓箭","icon":"arrow","des":"100金=100弓箭。每次远程攻击会消耗1弓箭，弓箭消耗完后不能攻击，记得补充哦。","price":"100","qua":"0","atk":"0","dur":"0","wei":"0","th":"0","bh":"0","ba":"0","pa":"0","bs":"0","hit":"0","hh":"0","range":"0","effect":"{}","skills":"[]"},{"id":"4","type":"饰品","icon":"jewelry-00","des":"饰品能提高个人能力。","price":"1000","qua":"0","atk":"0","dur":"0","wei":"0","th":"0","bh":"0","ba":"0","pa":"0","bs":"0","hit":"0","hh":"0","range":"0","effect":"{}","skills":"[]"},{"id":"5","type":"劣马","icon":"horse-00","des":"虽然是劣马，但肯定比走路快。","price":"320","qua":"0","atk":"0","dur":"32","wei":"0","th":"0","bh":"0","ba":"0","pa":"0","bs":"0","hit":"0","hh":"0","range":"0","effect":"{}","skills":"[15,3,4]"},{"id":"6","type":"中马","icon":"horse-01","des":"中等马，没有什么特别。","price":"1120","qua":"0","atk":"0","dur":"56","wei":"0","th":"0","bh":"0","ba":"0","pa":"0","bs":"0","hit":"0","hh":"0","range":"0","effect":"{}","skills":"[15,3,4]"},{"id":"7","type":"良马","icon":"horse-02","des":"优质马，耐久度特别高。","price":"2400","qua":"0","atk":"0","dur":"80","wei":"0","th":"0","bh":"0","ba":"0","pa":"0","bs":"0","hit":"0","hh":"0","range":"0","effect":"{}","skills":"[15,3,4]"},{"id":"8","type":"轻甲","icon":"armour-00","des":"轻盈的盔甲，只有简单的保护能力。","price":"320","qua":"0","atk":"0","dur":"32","wei":"2","th":"0","bh":"0","ba":"0","pa":"0","bs":"0","hit":"0","hh":"0","range":"0","effect":"{}","skills":"[]"},{"id":"9","type":"中甲","icon":"armour-01","des":"中型盔甲，兼顾轻盈和耐久。","price":"1120","qua":"0","atk":"0","dur":"56","wei":"4","th":"0","bh":"0","ba":"0","pa":"0","bs":"0","hit":"0","hh":"0","range":"0","effect":"{}","skills":"[]"},{"id":"10","type":"重甲","icon":"armour-02","des":"重型盔甲，虽然笨重，但是保护能力很强。","price":"2400","qua":"0","atk":"0","dur":"80","wei":"6","th":"0","bh":"0","ba":"0","pa":"0","bs":"0","hit":"0","hh":"0","range":"0","effect":"{}","skills":"[]"},{"id":"11","type":"轻盔","icon":"hat-00","des":"轻盈的头盔，可能不小心就被爆头了。","price":"160","qua":"0","atk":"0","dur":"16","wei":"1","th":"0","bh":"0","ba":"0","pa":"0","bs":"0","hit":"0","hh":"0","range":"0","effect":"{}","skills":"[]"},{"id":"12","type":"中盔","icon":"hat-01","des":"中型头盔，有一定保护能力。","price":"560","qua":"0","atk":"0","dur":"28","wei":"3","th":"0","bh":"0","ba":"0","pa":"0","bs":"0","hit":"0","hh":"0","range":"0","effect":"{}","skills":"[]"},{"id":"13","type":"重盔","icon":"hat-02","des":"重型头盔，全方位保护你的头部。","price":"1200","qua":"0","atk":"0","dur":"40","wei":"5","th":"0","bh":"0","ba":"0","pa":"0","bs":"0","hit":"0","hh":"0","range":"0","effect":"{}","skills":"[]"},{"id":"14","type":"轻盾","icon":"shield-00","des":"虽然是普通一块盾牌，但感觉很有安全感。","price":"280","qua":"0","atk":"20","dur":"28","wei":"2","th":"0","bh":"10","ba":"10","pa":"20","bs":"20","hit":"-15","hh":"45","range":"1","effect":"{}","skills":"[17,6]"},{"id":"15","type":"中盾","icon":"shield-01","des":"盾牌有点重，保护能力也不错。","price":"700","qua":"0","atk":"25","dur":"35","wei":"4","th":"0","bh":"15","ba":"15","pa":"20","bs":"25","hit":"-16","hh":"48","range":"1","effect":"{}","skills":"[17,6]"},{"id":"16","type":"重盾","icon":"shield-02","des":"很重很扎实的盾，防御人员必备。","price":"1260","qua":"0","atk":"30","dur":"42","wei":"6","th":"0","bh":"20","ba":"20","pa":"20","bs":"30","hit":"-18","hh":"52","range":"1","effect":"{}","skills":"[17,6]"},{"id":"17","type":"匕首","icon":"dagger-00","des":"使用恰当，能扎到对面怀疑人生。","price":"200","qua":"0","atk":"10","dur":"15","wei":"0","th":"0","bh":"10","ba":"10","pa":"50","bs":"0","hit":"0","hh":"10","range":"1","effect":"{}","skills":"[0,7]"},{"id":"18","type":"戟","icon":"halberd-00","des":"简单实用的兵器。","price":"400","qua":"0","atk":"20","dur":"25","wei":"1","th":"0","bh":"65","ba":"65","pa":"25","bs":"30","hit":"0","hh":"35","range":"1","effect":"{}","skills":"[1,8]"},{"id":"19","type":"长戟","icon":"halberd-long-00","des":"农民能快速掌握的兵器。","price":"480","qua":"0","atk":"24","dur":"25","wei":"2","th":"1","bh":"60","ba":"60","pa":"25","bs":"30","hit":"-10","hh":"40","range":"2","effect":"{}","skills":"[2,9]"},{"id":"20","type":"剑","icon":"sword-00","des":"据说双手持剑的武士特别帅。","price":"500","qua":"0","atk":"25","dur":"25","wei":"1","th":"0","bh":"50","ba":"50","pa":"30","bs":"20","hit":"0","hh":"30","range":"1","effect":"{}","skills":"[1,11]"},{"id":"21","type":"斧","icon":"axe-00","des":"杀伤力有点高，但有点重，不容易瞄准。","price":"660","qua":"0","atk":"33","dur":"25","wei":"2","th":"0","bh":"80","ba":"80","pa":"25","bs":"25","hit":"-12","hh":"35","range":"1","effect":"{}","skills":"[1,12]"},{"id":"22","type":"长斧","icon":"axe-long-00","des":"杀伤力很高，但也很容易打偏。","price":"800","qua":"0","atk":"40","dur":"25","wei":"5","th":"1","bh":"80","ba":"80","pa":"30","bs":"30","hit":"-15","hh":"40","range":"2","effect":"{}","skills":"[2,13]"},{"id":"23","type":"长枪","icon":"spear-long-00","des":"长枪很容易瞄准头部，还能一串二哦。","price":"500","qua":"0","atk":"25","dur":"25","wei":"2","th":"0","bh":"30","ba":"30","pa":"30","bs":"10","hit":"10","hh":"45","range":"2","effect":"{}","skills":"[2,14]"},{"id":"24","type":"弓","icon":"bow-00","des":"远程攻击必备。","price":"440","qua":"0","atk":"22","dur":"25","wei":"3","th":"1","bh":"30","ba":"30","pa":"20","bs":"10","hit":"-30","hh":"55","range":"2~5","effect":"{}","skills":"[19,10]"}],"skills":[{"id":"99","type":"结束","ap":"0","class":"2","rangeID":"0","account":"0","active":"1","effect":"{}","buffs":"[]","des":"结束自己回合"},{"id":"-1","type":"移动","ap":"3","class":"2","rangeID":"0","account":"0","active":"1","effect":"{}","buffs":"[]","des":"移动"},{"id":"0","type":"普攻2","ap":"2","class":"1","rangeID":"1","account":"1","active":"1","effect":"{}","buffs":"[]","des":"普通攻击，消耗2ap"},{"id":"1","type":"普攻3","ap":"3","class":"1","rangeID":"5","account":"1","active":"1","effect":"{}","buffs":"[]","des":"普通攻击，消耗3ap"},{"id":"2","type":"普攻4","ap":"4","class":"1","rangeID":"4","account":"1","active":"1","effect":"{}","buffs":"[]","des":"普通攻击，消耗4ap"},{"id":"3","type":"加速","ap":"6","class":"0","rangeID":"0","account":"0","active":"1","effect":"{\'move\':2}","buffs":"[]","des":"开始时使用，移动机+2，不能攻击"},{"id":"4","type":"冲击","ap":"4","class":"1","rangeID":"1","account":"0","active":"1","effect":"{}","buffs":"[]","des":"把自己和目标推进一格"},{"id":"5","type":"下马","ap":"3","class":"0","rangeID":"0","account":"0","active":"1","effect":"{}","buffs":"[]","des":"卸载马"},{"id":"6","type":"推击","ap":"3","class":"1","rangeID":"1","account":"1","active":"1","effect":"{}","buffs":"[]","des":"攻击，推开目标1格，如果目标后面是障碍物则眩晕一回合"},{"id":"7","type":"要害","ap":"3","class":"1","rangeID":"1","account":"1","active":"1","effect":"{\'pa\':50}","buffs":"[]","des":"攻击，穿甲+50%"},{"id":"8","type":"爆头","ap":"4","class":"1","rangeID":"5","account":"1","active":"1","effect":"{\'hh\':60}","buffs":"[]","des":"攻击，爆头+60%"},{"id":"9","type":"钩击","ap":"4","class":"1","rangeID":"3","account":"1","active":"1","effect":"{}","buffs":"[]","des":"攻击，把目标勾过来1格"},{"id":"10","type":"瞄准4","ap":"4","class":"1","rangeID":"6","account":"1","active":"1","effect":"{\'hit\':50}","buffs":"[]","des":"攻击，命中+50%"},{"id":"11","type":"瞄准5","ap":"4","class":"1","rangeID":"5","account":"1","active":"1","effect":"{\'hit\':40}","buffs":"[]","des":"攻击，命中+40%"},{"id":"12","type":"破盾","ap":"4","class":"1","rangeID":"1","account":"1","active":"1","effect":"{\'bs\':75}","buffs":"[]","des":"攻击，破盾+75%"},{"id":"13","type":"旋风斩","ap":"6","class":"1","rangeID":"7","account":"1","active":"1","effect":"{}","buffs":"[]","des":"攻击周围目标"},{"id":"14","type":"穿击2","ap":"4","class":"1","rangeID":"2","account":"1","active":"1","effect":"{}","buffs":"[]","des":"攻击目标及后一格"},{"id":"15","type":"骑马","ap":"0","class":"0","rangeID":"0","account":"0","active":"1","effect":"{\'move\':1,\'hit\':-10}","buffs":"[]","des":"骑马状态，移动+1，命中-10%"},{"id":"16","type":"上马","ap":"3","class":"0","rangeID":"0","account":"0","active":"1","effect":"{}","buffs":"[]","des":"装备马"},{"id":"17","type":"架盾","ap":"3","class":"0","rangeID":"0","account":"0","active":"1","effect":"{}","buffs":"[0]","des":"架盾状态，移动力-1，命中-12，对方只能攻击盾牌"},{"id":"18","type":"下盾","ap":"3","class":"0","rangeID":"0","account":"0","active":"1","effect":"{}","buffs":"[0]","des":"取消架盾状态（删除架盾buff）"},{"id":"19","type":"射击3","ap":"3","class":"1","rangeID":"6","account":"1","active":"1","effect":"{}","buffs":"[]","des":"普通射击，消耗3ap"}],"skillRange":[{"id":"0","effective":"[[0,0]]","type":"1","trigger":"[[0,0]]"},{"id":"1","effective":"[[0,-1],[1,0],[0,1],[-1,0]]","type":"1","trigger":"[[0,0]]"},{"id":"2","effective":"[[0,-1],[1,0],[0,1],[-1,0],[0,-2],[2,0],[0,2],[-2,0]]","type":"2","trigger":"[[[0,-1],[0,-2]],[[1,0],[2,0]],[[0,1],[0,2]],[[-1,0],[-2,0]]]"},{"id":"3","effective":"[[0,-2],[2,0],[0,2],[-2,0]]","type":"1","trigger":"[[0,0]]"},{"id":"4","effective":"[[0,-1],[1,0],[0,1],[-1,0],[0,-2],[2,0],[0,2],[-2,0]]","type":"1","trigger":"[[0,0]]"},{"id":"5","effective":"[[-1,-1],[0,-1],[1,-1],[-1,0],[1,0],[-1,1],[0,1],[1,1]]","type":"1","trigger":"[[0,0]]"},{"id":"6","effective":"[[-3,-3],[-2,-3],[-1,-3],[0,-3],[1,-3],[2,-3],[3,-3],[-3,-2],[-2,-2],[-1,-2],[0,-2],[1,-2],[2,-2],[3,-2],[-3,-1],[-2,-1],[2,-1],[3,-1],[-3,0],[-2,0],[2,0],[3,0],[-3,1],[-2,1],[2,1],[3,1],[-3,2],[-2,2],[-1,2],[0,2],[1,2],[2,2],[3,2],[-3,3],[-2,3],[-1,3],[0,3],[1,3],[2,3],[3,3]]","type":"1","trigger":"[[0,0]]"},{"id":"7","effective":"[[0,-1],[1,0],[0,1],[-1,0]]","type":"2","trigger":"[[[0,-1],[1,0],[0,1],[-1,0]]]"}],"buffs":[{"id":"0","type":"架盾","class":"1","round":"-1","roundUnit":"time","effect":"{\'move\':-1,\'hit\':-12}","des":"架盾状态，移动力-1，命中-12，对方只能攻击盾牌","":""},{"id":"1","type":"眩晕","class":"2","round":"1","roundUnit":"time","effect":"{}","des":"自动跳过当前回合","":""}]}')},df89:function(e,t,i){},e2ce:function(e,t,i){},fd0f:function(e,t,i){i("7db0"),i("a9e3"),i("d3b7"),i("25f0"),function(){var e=window.common={random:function(e,t){return Math.round(Math.random()*(t-e)+e)},indexOf2Array:function(e,t){for(var i=0;i<t.length;i++)if(t[i][0]==e[0]&&t[i][1]==e[1])return i;return-1},creatPoint:function(t,i,a){if(a.length>=(t+1)*(i+1))return console.error("坐标已填满数组,计算超出范围!"),null;var s=[e.random(0,t),e.random(0,i)];return-1!=e.indexOf2Array(s,a)&&(s=e.creatPoint(t,i,a)),s},createRandomName:function(){var e=new Array("赵","钱","孙","李","周","吴","郑","王","冯","陈","褚","卫","蒋","沈","韩","杨","朱","秦","尤","许","何","吕","施","张","孔","曹","严","华","金","魏","陶","姜","戚","谢","邹","喻","柏","水","窦","章","云","苏","潘","葛","奚","范","彭","郎","鲁","韦","昌","马","苗","凤","花","方","俞","任","袁","柳","酆","鲍","史","唐","费","廉","岑","薛","雷","贺","倪","汤","滕","殷","罗","毕","郝","邬","安","常","乐","于","时","傅","皮","卞","齐","康","伍","余","元","卜","顾","孟","平","黄","和","穆","萧","尹"),t=new Array("子","淼","国","夫","堂","甜","敏","尚","贤","祥","轩","易","辰","帆","冉","瑾","昆","齐","杨","文","东","雄","浩","熙","溶","枫","欣","豪","慧","政","美","慧","岩","杰","源","忠","润","汝","嘉","新","建","亦","林","冰","佳","涵","禹","淳","泽","洋","越","昊","翔","华","晶","凌","溪","涛","怡","毅","屇","琪","紫","瑞","昕","萌","明","宜","远","阔","羽","惠","晨","一","震","鑫","君","京","莎","汕","钰","区","庆","鸣","语","池","添","海","雅","蛮","清","诗","乐","典","赫","傲","龙","飞","云","坡"),i=parseInt(100*Math.random()),a=e[i],s=parseInt(100*Math.random()),n=t[s];return a+n},createUniqueId:function(){return Number(Math.random().toString().substr(3,5)+Date.now()).toString(36)},getPoint:function(e){var t=[];return void 0!=e.clientX?(t[0]=e.clientX,t[1]=e.clientY):(t[0]=e.targetTouches[0].pageX,t[1]=e.targetTouches[0].pageY),t},getMapPoint:function(t,i,a){var s=e.getPoint(t);return s[0]=parseInt((s[0]-a.offsetLeft)/i),s[1]=parseInt((s[1]-a.offsetTop)/i),s},getNumberInNormalDistribution:function(e,t){var i=0,a=0,s=0,n=0;do{i=2*Math.random()-1,a=2*Math.random()-1,s=i*i+a*a}while(0==s||s>=1);return n=Math.sqrt(-2*Math.log(s)/s),Math.round(e+i*n*t)},getNumberInAppoint:function(e){for(var t=Math.random(),i=0;i<e.length;i++){for(var a=0,s=0;s<=i;s++)a+=e[s][1];if(t<a)return e[i][0]}},getNumberInDecrement:function(e){for(var t=Math.random(),i=0,a=1;a<=e;a++)i+=a;for(var s=1/i,n=1;n<=e;n++){for(var o=0,r=1;r<e+1-n;r++)o+=r;if(t<1-s*o)return n}},getTypeName:function(e,t){return data[e].find((function(e){return e.id==t})).type},getGoods:function(e,t){if(""!=e&&void 0!=e)return game.curSave[t].find((function(t){return t.id==e}))}}}()},ff13:function(e,t,i){"use strict";var a=i("26d0"),s=i.n(a);s.a},ff96:function(e,t,i){"use strict";var a=i("e2ce"),s=i.n(a);s.a}});
//# sourceMappingURL=app.7059be3c.js.map